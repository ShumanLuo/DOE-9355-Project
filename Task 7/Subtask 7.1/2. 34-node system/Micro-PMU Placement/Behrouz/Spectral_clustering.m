clc
clear
close all
%% voltages and currents
%load 1000Scen_with_current_pu
%load 1000Scen_PV_with_current_pu
%load 1000Scen_3PVs_with_current_pu
%load 1000Scen_3PVs_with_current_pu_860_848_mid822
% load 1000Scen_3PVs_with_current_pu_860_848_mid822_varing_feeder_head_erronous
% R_input_voltage = R_input_voltage_erronous;
load 1000Scen_3PVs_with_current_pu_860_848_mid822_varing_feeder_head
% removing small zero currents
% temp1 = mean(R_input_current(:,1:size(R_input_current,2)/2));
% temp2 = find (temp1 <0.000001); 
% All_currents_WLS_names_ready(temp2,:) = [];
% temp2 = [temp2,temp2+size(R_input_current,2)/2];
% R_input_current(:,temp2) = [];
%% removing constant voltage magnitudes and their corresponding phase angles.
temp1  = std(R_input_voltage(:,1:size(R_input_voltage,2)/2));
temp2 = find (temp1 <0.001); 
node_voltage_names_separated(temp2,:) = [];
temp2 = [temp2,temp2+size(R_input_voltage,2)/2];
R_input_voltage(:,temp2) = [];

%% removing constant current magnitudes and their corresponding phase angles.
% temp1  = std(R_input_current(:,1:size(R_input_current,2)/2));
% temp2 = find (temp1 < 1e-5); 
% All_currents_WLS_names_ready(temp2,:) = [];
% temp2 = [temp2,temp2+size(R_input_current,2)/2];
% R_input_current(:,temp2) = [];

%% voltage - voltage analysis
%% finding the index voltage for each phase
phase_A_voltage_mag_index= [];
phase_B_voltage_mag_index= [];
phase_C_voltage_mag_index= [];
for i = 1:size (node_voltage_names_separated,1)
    if strcmp(node_voltage_names_separated{i,2},'1')
        phase_A_voltage_mag_index = [phase_A_voltage_mag_index,i];
    elseif strcmp(node_voltage_names_separated{i,2},'2')
        phase_B_voltage_mag_index = [phase_B_voltage_mag_index,i];
    elseif strcmp(node_voltage_names_separated{i,2},'3')
        phase_C_voltage_mag_index = [phase_C_voltage_mag_index,i];
    end
end


phase_A_voltage_mag_index = [1,4,7,10,14,17,20,23,26,30,31,27,33,36,39,70,42,73,84,45,76,48,51,60,63,66,77,54,57,80];
phase_B_voltage_mag_index = [2,5,8,11,13,15,18,21,24,28,32,34,37,40,69,71,43,74,85,46,49,52,61,64,67,78,55,58,81,83];
phase_C_voltage_mag_index = [3,6,9,12,16,19,22,25,29,35,38,41,72,44,75,86,47,50,53,62,65,68,79,56,59,82];


phase_A_voltage_ang_index = phase_A_voltage_mag_index + size(R_input_voltage,2)/2;
phase_B_voltage_ang_index = phase_B_voltage_mag_index + size(R_input_voltage,2)/2;
phase_C_voltage_ang_index = phase_C_voltage_mag_index + size(R_input_voltage,2)/2;
R_mag_A = corr(R_input_voltage(:,phase_A_voltage_mag_index),'type','Spearman');
R_mag_B = corr(R_input_voltage(:,phase_B_voltage_mag_index),'type','Spearman');
R_mag_C = corr(R_input_voltage(:,phase_C_voltage_mag_index),'type','Spearman');
R_ang_A = corr(R_input_voltage(:,phase_A_voltage_ang_index),'type','Spearman');
R_ang_B = corr(R_input_voltage(:,phase_B_voltage_ang_index),'type','Spearman');
R_ang_C = corr(R_input_voltage(:,phase_C_voltage_ang_index),'type','Spearman');
min_correlation = [min(min(R_mag_A)),min(min(R_mag_B)),min(min(R_mag_C)),min(min(R_ang_A)),min(min(R_ang_B)),min(min(R_ang_C))];
    
method = 'ward';
%method = 'average';
Hierarchical_results_A_mag = linkage(R_mag_A,method);
Hierarchical_results_B_mag = linkage(R_mag_B,method);
Hierarchical_results_C_mag = linkage(R_mag_C,method);
Hierarchical_results_A_ang = linkage(R_ang_A,method);
Hierarchical_results_B_ang = linkage(R_ang_B,method);
Hierarchical_results_C_ang = linkage(R_ang_C,method);
maximum_number_of_clusters = 2;
cluster_A_mag = cluster(Hierarchical_results_A_mag,'MaxClust',maximum_number_of_clusters) ;
cluster_B_mag = cluster(Hierarchical_results_B_mag,'MaxClust',maximum_number_of_clusters) ;
cluster_C_mag = cluster(Hierarchical_results_C_mag,'MaxClust',maximum_number_of_clusters) ;
cluster_A_ang = cluster(Hierarchical_results_A_ang,'MaxClust',maximum_number_of_clusters) ;
cluster_B_ang = cluster(Hierarchical_results_B_ang,'MaxClust',maximum_number_of_clusters) ;
cluster_C_ang = cluster(Hierarchical_results_C_ang,'MaxClust',maximum_number_of_clusters) ;
 
phase_A_voltage_names = node_voltage_names_separated(phase_A_voltage_mag_index ,1);
phase_B_voltage_names = node_voltage_names_separated(phase_B_voltage_mag_index ,1);
phase_C_voltage_names = node_voltage_names_separated(phase_C_voltage_mag_index ,1);





heatmap(R_mag_A,'FontName', 'Times New Roman', 'FontSize', 14,'Colormap',parula)
ax = gca;
ax.XData =[phase_A_voltage_names];
ax.YData =[phase_A_voltage_names];
title ('Phase A voltage magnitude CC matrix')
xlabel('node voltage name')
ylabel('node voltage name')

figure

heatmap(R_ang_A,'FontName', 'Times New Roman', 'FontSize', 14)
ax = gca;
ax.XData =[phase_A_voltage_names];
ax.YData =[phase_A_voltage_names];
title ('Phase A voltage angle CC matrix')
xlabel('node voltage name')
ylabel('node voltage name')
%% plotting for the paper
phase_A_reordering = [1,2,3,4,5,8,6,7,9,10,11,13,16,18,19,24,25,20,21,22,12,14,17,23,26,15];
tiledlayout(2,3)
nexttile
heatmap(R_mag_A(phase_A_reordering,phase_A_reordering),'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase A Mag')
nexttile
heatmap(R_mag_B,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase B Mag')
nexttile
heatmap(R_mag_C,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase C Mag')
nexttile
heatmap(R_ang_A(phase_A_reordering,phase_A_reordering),'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase A Ang')
nexttile
heatmap(R_ang_B,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase B Ang')
nexttile
heatmap(R_ang_C,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
title('Phase C Ang')
%% current - voltage analysis
%% finding the index current for each phase
phase_A_current_mag_index= [];
phase_B_current_mag_index= [];
phase_C_current_mag_index= [];
for i = 1:size (All_currents_WLS_names_ready,1)
    if strcmp(All_currents_WLS_names_ready{i,3},'1')
        phase_A_current_mag_index = [phase_A_current_mag_index,i];
    elseif strcmp(All_currents_WLS_names_ready{i,3},'2')
        phase_B_current_mag_index = [phase_B_current_mag_index,i];
    elseif strcmp(All_currents_WLS_names_ready{i,3},'3')
        phase_C_current_mag_index = [phase_C_current_mag_index,i];
    end
end

phase_A_current_ang_index = phase_A_current_mag_index + size(R_input_current,2)/2;
phase_B_current_ang_index = phase_B_current_mag_index + size(R_input_current,2)/2;
phase_C_current_ang_index = phase_C_current_mag_index + size(R_input_current,2)/2;
R_mag_A_current = corr([R_input_voltage(:,phase_A_voltage_mag_index),R_input_current(:,phase_A_current_mag_index)],'type','Spearman');
R_mag_B_current = corr([R_input_voltage(:,phase_B_voltage_mag_index),R_input_current(:,phase_B_current_mag_index)],'type','Spearman');
R_mag_C_current = corr([R_input_voltage(:,phase_C_voltage_mag_index),R_input_current(:,phase_C_current_mag_index)],'type','Spearman');
R_ang_A_current = corr([R_input_voltage(:,phase_A_voltage_ang_index),R_input_current(:,phase_A_current_ang_index)],'type','Spearman');
R_ang_B_current = corr([R_input_voltage(:,phase_B_voltage_ang_index),R_input_current(:,phase_B_current_ang_index)],'type','Spearman');
R_ang_C_current = corr([R_input_voltage(:,phase_C_voltage_ang_index),R_input_current(:,phase_C_current_ang_index)],'type','Spearman');

method = 'average';
Hierarchical_results_A_mag_current = linkage(R_mag_A_current(1:size(R_input_voltage(:,phase_A_voltage_mag_index),2),size(R_input_voltage(:,phase_A_voltage_mag_index),2)+1:end),method);
Hierarchical_results_B_mag_current = linkage(R_mag_B_current,method);
Hierarchical_results_C_mag_current = linkage(R_mag_C_current,method);
Hierarchical_results_A_ang_current = linkage(R_ang_A_current,method);
Hierarchical_results_B_ang_current = linkage(R_ang_B_current,method);
Hierarchical_results_C_ang_current = linkage(R_ang_C_current,method);
cluster_A_mag_current = cluster(Hierarchical_results_A_mag_current,'MaxClust',2) ;
cluster_B_mag_current = cluster(Hierarchical_results_B_mag_current,'MaxClust',2) ;
cluster_C_mag_current = cluster(Hierarchical_results_C_mag_current,'MaxClust',2) ;
cluster_A_ang_current = cluster(Hierarchical_results_A_ang_current,'MaxClust',2) ;
cluster_B_ang_current = cluster(Hierarchical_results_B_ang_current,'MaxClust',2) ;
cluster_C_ang_current = cluster(Hierarchical_results_C_ang_current,'MaxClust',2) ;

%all_clusters = [cluster_A_mag,cluster_B_mag,cluster_C_mag,cluster_A_ang,cluster_B_ang,cluster_C_ang];

[H,T,outperm] = dendrogram(Hierarchical_results_A_ang,'ColorThreshold','default');
inconsistency_R = inconsistent(Hierarchical_results_A_ang);
%T = cluster(Hierarchical_results_A_mag,'cutoff',abs(max(inconsistency_R(:,4))-(10^(-15))));
T = cluster(Hierarchical_results_A_mag,'MaxClust',2) ;
heatmap(R_ang_A,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
figure
heatmap(R_ang_B,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
figure
heatmap(R_ang_C,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
%target_phase = find (str2double(All_currents_WLS_names_ready(:,3))==1 && All_currents_WLS_names_ready{});
% the hard coded below is very sketchy. watch out
target_phase_mag_current = [1 7 13 19 25 31 37 43 45 48 51 53 55 58 61 64 67 73 76 79 82 85 92 95 98 101 104 107 110 116 122 125 128 132 138]; % these are for phase A
%target_phase_mag_current = [1 7 13 20 26 32 38 44 52 54 46 56 62 68 117 123 74 129 80 86 98 104 110 130 136 92 142 153 147]; % these are for phase A
target_phase_ang_current = target_phase_mag_current + size(R_input_current,2)/2;
% target_phase_mag_voltage = find (str2double(node_voltage_names_separated(:,2))==1);
% temp1 = target_phase_mag_voltage(end-1);
% temp2 = target_phase_mag_voltage(end-4);
% target_phase_mag_voltage(end-1) = temp2;
% target_phase_mag_voltage(end-4) = temp1;
% Phase A
%target_phase_mag_voltage = [4 7 10 14 17 20 23 26 30 31 27 33 36 39 70 42 45 76 48 51 60 63 66 77 54 57 80 73 84];
target_phase_mag_voltage = [4, 7, 10, 14, 17, 20, 23, 26, 27, 30, 31, 33, 36, 39, 42, 45, 48, 51, 54, 57, 60, 63, 66, 70, 80, 76, 77, 73, 84];
% Phase C
%target_phase_mag_voltage = [6 9 12 16 19 22 25 29 35 38 41 44 47 50 53 56 59 62 65 68 72 75 79 82 86];
target_phase_ang_voltage = target_phase_mag_voltage + size(R_input_voltage,2)/2;
%R = corr([R_input_voltage(:,target_phase_ang_voltage),R_input_current(:,target_phase_ang_current)],'type','Spearman');
R = corr(R_input_voltage(:,target_phase_ang_voltage),'type','Spearman');
target_phase_names_voltages = node_voltage_names_separated(target_phase_mag_voltage,1);
counter = 1;
for i = 1:length(target_phase_mag_current)
    target_phase_names_currents{i,1} = strcat(All_currents_WLS_names_ready(target_phase_mag_current(i),1),'-',All_currents_WLS_names_ready(target_phase_mag_current(i),2));
end
%R = corr(R_input_voltage(:,target_phase_ang_voltage),'type','Spearman');
%figure
heatmap(R,'FontName', 'Times New Roman', 'FontSize', 12,'Colormap',parula)
%heatmap(R)
%xticks([1:length(target_phase_names)])
%xticklabels(target_phase_names);
ax = gca;
%ax.XData =[target_phase_names_voltages,target_phase_names_currents];
%ax.YData =[target_phase_names_voltages,target_phase_names_currents];
ax.XData =target_phase_names_voltages;
ax.YData =target_phase_names_voltages;
%xtickangle(90)

% creating excel sheets for estimating MI in python
%writematrix(R_input_voltage,'C:\Users\bazimian\OneDrive\Research\Dr. Anamitra Pal\34 Node system\34 node system\Spectral clusterting\voltage.csv')
%writematrix(R_input_current,'C:\Users\bazimian\OneDrive\Research\Dr. Anamitra Pal\34 Node system\34 node system\Spectral clusterting\current.csv')
%figure
%scatter (R_input_voltage(:,73+size(R_input_voltage,2)/2),R_input_voltage(:,84+size(R_input_voltage,2)/2))
%scatter (R_input_voltage(:,42),R_input_voltage(:,73))

% Hierarchical_results = linkage(R,'average');
% inconsistency_R = inconsistent(Hierarchical_results); 

%R= [5.64964000000000,4.32392000000000,2.93423000000000,2.81446000000000,2.73352000000000,2.73483000000000,2.73203000000000,2.73180000000000,2.74885000000000,2.75622000000000,2.45729000000000,2.43199000000000,2.00349000000000,1.99526000000000,1.58789000000000,1.58713000000000,1.54986000000000,1.54980000000000,1.51834000000000,1.51938000000000,1.51481000000000,1.51526000000000,1.51665000000000,1.51236000000000,1.51222000000000,1.51223000000000,1.51204000000000,0.735329000000000,0.506144000000000;4.32343000000000,5.64914000000000,3.15118000000000,2.99161000000000,2.90690000000000,2.90745000000000,2.90506000000000,2.90722000000000,2.91753000000000,2.91680000000000,2.57324000000000,2.53921000000000,2.04696000000000,2.03615000000000,1.59677000000000,1.59627000000000,1.57456000000000,1.57469000000000,1.54780000000000,1.54717000000000,1.54390000000000,1.53693000000000,1.53871000000000,1.53830000000000,1.53906000000000,1.53847000000000,1.53762000000000,0.741411000000000,0.499058000000000;2.93443000000000,3.15130000000000,5.65114000000000,3.94756000000000,3.69071000000000,3.69829000000000,3.67983000000000,3.68492000000000,3.68343000000000,3.67719000000000,3.00695000000000,2.95420000000000,2.15441000000000,2.14344000000000,1.64318000000000,1.64528000000000,1.62222000000000,1.62218000000000,1.60415000000000,1.60571000000000,1.61037000000000,1.60803000000000,1.61493000000000,1.59905000000000,1.59820000000000,1.59779000000000,1.59773000000000,0.724464000000000,0.508970000000000;2.81423000000000,2.99146000000000,3.94756000000000,5.65114000000000,4.76389000000000,4.78255000000000,4.73559000000000,4.73699000000000,4.60564000000000,4.54653000000000,3.16819000000000,3.09968000000000,2.22847000000000,2.21823000000000,1.68098000000000,1.68313000000000,1.65054000000000,1.65048000000000,1.62287000000000,1.62293000000000,1.62118000000000,1.62636000000000,1.62766000000000,1.62695000000000,1.61373000000000,1.61355000000000,1.61448000000000,0.721329000000000,0.487952000000000;2.73309000000000,2.90690000000000,3.69071000000000,4.76389000000000,5.65080000000000,5.58747000000000,5.55855000000000,5.56829000000000,4.76760000000000,4.68001000000000,3.23617000000000,3.16449000000000,2.24819000000000,2.23591000000000,1.69758000000000,1.69969000000000,1.66701000000000,1.66702000000000,1.63908000000000,1.63981000000000,1.63784000000000,1.63252000000000,1.63454000000000,1.63907000000000,1.62784000000000,1.62837000000000,1.62855000000000,0.729622000000000,0.482433000000000;2.73436000000000,2.90745000000000,3.69829000000000,4.78255000000000,5.58747000000000,5.65114000000000,5.49324000000000,5.49985000000000,4.76313000000000,4.67854000000000,3.22928000000000,3.15966000000000,2.24498000000000,2.23303000000000,1.69579000000000,1.69724000000000,1.66492000000000,1.66500000000000,1.63784000000000,1.63871000000000,1.63698000000000,1.63131000000000,1.63276000000000,1.63809000000000,1.62731000000000,1.62711000000000,1.62801000000000,0.728769000000000,0.482378000000000;2.73209000000000,2.90506000000000,3.67983000000000,4.73559000000000,5.55855000000000,5.49324000000000,5.65114000000000,5.60017000000000,4.73937000000000,4.65098000000000,3.24887000000000,3.17382000000000,2.25121000000000,2.23877000000000,1.70149000000000,1.70230000000000,1.67080000000000,1.67097000000000,1.64100000000000,1.64337000000000,1.63914000000000,1.63404000000000,1.63655000000000,1.63983000000000,1.62887000000000,1.62882000000000,1.62930000000000,0.729930000000000,0.484539000000000;2.73188000000000,2.90722000000000,3.68492000000000,4.73699000000000,5.56829000000000,5.49985000000000,5.60017000000000,5.65114000000000,4.76100000000000,4.67311000000000,3.24438000000000,3.17115000000000,2.24976000000000,2.23679000000000,1.70050000000000,1.70176000000000,1.67032000000000,1.67033000000000,1.64132000000000,1.64278000000000,1.63942000000000,1.63382000000000,1.63667000000000,1.63905000000000,1.62853000000000,1.62856000000000,1.62784000000000,0.729294000000000,0.483505000000000;2.74878000000000,2.91763000000000,3.68343000000000,4.60564000000000,4.76760000000000,4.76313000000000,4.73937000000000,4.76100000000000,5.65114000000000,5.46958000000000,3.11341000000000,3.04307000000000,2.21010000000000,2.19770000000000,1.67756000000000,1.67781000000000,1.65053000000000,1.65055000000000,1.62665000000000,1.62739000000000,1.62044000000000,1.62168000000000,1.61619000000000,1.62403000000000,1.61807000000000,1.61779000000000,1.61804000000000,0.721662000000000,0.478007000000000;2.75638000000000,2.91690000000000,3.67719000000000,4.54653000000000,4.68001000000000,4.67854000000000,4.65098000000000,4.67311000000000,5.46958000000000,5.65089000000000,3.10148000000000,3.03384000000000,2.20233000000000,2.18925000000000,1.67233000000000,1.67373000000000,1.64740000000000,1.64749000000000,1.62486000000000,1.62317000000000,1.61478000000000,1.61768000000000,1.61366000000000,1.61992000000000,1.61179000000000,1.61148000000000,1.61136000000000,0.722599000000000,0.478723000000000;2.45728000000000,2.57309000000000,3.00695000000000,3.16819000000000,3.23617000000000,3.22928000000000,3.24887000000000,3.24438000000000,3.11341000000000,3.10148000000000,5.65114000000000,5.16547000000000,2.70881000000000,2.68955000000000,1.92526000000000,1.92678000000000,1.89454000000000,1.89444000000000,1.85926000000000,1.86079000000000,1.84749000000000,1.83455000000000,1.83269000000000,1.85232000000000,1.84470000000000,1.84454000000000,1.84558000000000,0.702595000000000,0.473050000000000;2.43182000000000,2.53939000000000,2.95420000000000,3.09968000000000,3.16449000000000,3.15966000000000,3.17382000000000,3.17115000000000,3.04307000000000,3.03384000000000,5.16547000000000,5.65114000000000,2.74957000000000,2.73039000000000,1.94591000000000,1.94640000000000,1.91416000000000,1.91411000000000,1.87994000000000,1.87895000000000,1.86671000000000,1.85368000000000,1.85051000000000,1.87526000000000,1.86388000000000,1.86446000000000,1.86457000000000,0.703480000000000,0.470188000000000;2.00359000000000,2.04702000000000,2.15434000000000,2.22847000000000,2.24819000000000,2.24498000000000,2.25121000000000,2.24976000000000,2.21010000000000,2.20233000000000,2.70881000000000,2.74957000000000,5.65114000000000,5.39123000000000,2.52144000000000,2.51988000000000,2.45637000000000,2.45637000000000,2.39569000000000,2.39022000000000,2.36982000000000,2.34102000000000,2.34134000000000,2.39082000000000,2.35499000000000,2.35577000000000,2.35613000000000,0.707821000000000,0.463004000000000;1.99533000000000,2.03620000000000,2.14337000000000,2.21823000000000,2.23591000000000,2.23303000000000,2.23877000000000,2.23679000000000,2.19770000000000,2.18925000000000,2.68955000000000,2.73039000000000,5.39123000000000,5.65114000000000,2.53723000000000,2.53751000000000,2.47098000000000,2.47098000000000,2.41038000000000,2.40797000000000,2.38639000000000,2.35919000000000,2.35769000000000,2.40680000000000,2.37038000000000,2.37034000000000,2.37056000000000,0.709010000000000,0.458832000000000;1.58771000000000,1.59674000000000,1.64318000000000,1.68098000000000,1.69758000000000,1.69579000000000,1.70149000000000,1.70050000000000,1.67756000000000,1.67233000000000,1.92526000000000,1.94591000000000,2.52144000000000,2.53723000000000,5.65114000000000,5.59275000000000,4.66794000000000,4.66779000000000,4.11343000000000,4.09831000000000,4.01777000000000,3.75833000000000,3.71527000000000,4.01045000000000,3.84120000000000,3.84357000000000,3.84033000000000,0.694939000000000,0.457697000000000;1.58699000000000,1.59623000000000,1.64528000000000,1.68313000000000,1.69969000000000,1.69732000000000,1.70230000000000,1.70176000000000,1.67784000000000,1.67376000000000,1.92678000000000,1.94628000000000,2.51988000000000,2.53750000000000,5.59275000000000,5.65064000000000,4.67123000000000,4.67117000000000,4.10932000000000,4.09600000000000,4.02185000000000,3.75998000000000,3.71543000000000,4.01419000000000,3.84231000000000,3.84298000000000,3.84130000000000,0.695021000000000,0.457361000000000;1.54972000000000,1.57469000000000,1.62222000000000,1.65054000000000,1.66701000000000,1.66492000000000,1.67080000000000,1.67032000000000,1.65053000000000,1.64740000000000,1.89454000000000,1.91416000000000,2.45637000000000,2.47098000000000,4.66794000000000,4.67123000000000,5.65114000000000,5.65089000000000,4.60998000000000,4.58968000000000,4.43942000000000,4.02287000000000,3.95432000000000,4.43561000000000,4.11767000000000,4.11801000000000,4.11541000000000,0.690858000000000,0.453727000000000;1.54980000000000,1.57469000000000,1.62218000000000,1.65048000000000,1.66702000000000,1.66500000000000,1.67097000000000,1.67033000000000,1.65055000000000,1.64749000000000,1.89444000000000,1.91411000000000,2.45637000000000,2.47098000000000,4.66779000000000,4.67117000000000,5.65089000000000,5.65114000000000,4.61010000000000,4.58981000000000,4.43942000000000,4.02315000000000,3.95442000000000,4.43570000000000,4.11736000000000,4.11770000000000,4.11523000000000,0.690856000000000,0.453743000000000;1.51839000000000,1.54786000000000,1.60415000000000,1.62287000000000,1.63908000000000,1.63784000000000,1.64100000000000,1.64132000000000,1.62665000000000,1.62486000000000,1.85926000000000,1.87994000000000,2.39569000000000,2.41038000000000,4.11343000000000,4.10932000000000,4.60998000000000,4.61010000000000,5.65114000000000,5.51234000000000,4.95440000000000,4.17556000000000,4.09087000000000,4.89724000000000,4.35412000000000,4.35187000000000,4.35133000000000,0.690640000000000,0.455137000000000;1.51925000000000,1.54723000000000,1.60571000000000,1.62293000000000,1.63981000000000,1.63871000000000,1.64337000000000,1.64278000000000,1.62739000000000,1.62317000000000,1.86079000000000,1.87895000000000,2.39022000000000,2.40797000000000,4.09831000000000,4.09600000000000,4.58968000000000,4.58981000000000,5.51234000000000,5.65114000000000,5.06495000000000,4.21564000000000,4.12710000000000,4.82699000000000,4.30553000000000,4.30276000000000,4.30324000000000,0.691116000000000,0.454098000000000;1.51463000000000,1.54396000000000,1.61037000000000,1.62118000000000,1.63784000000000,1.63698000000000,1.63914000000000,1.63942000000000,1.62044000000000,1.61478000000000,1.84749000000000,1.86671000000000,2.36982000000000,2.38639000000000,4.01777000000000,4.02185000000000,4.43942000000000,4.43942000000000,4.95440000000000,5.06495000000000,5.65114000000000,4.45427000000000,4.34068000000000,4.49401000000000,4.11761000000000,4.11638000000000,4.11306000000000,0.693754000000000,0.452012000000000;1.51534000000000,1.53699000000000,1.60803000000000,1.62636000000000,1.63252000000000,1.63131000000000,1.63404000000000,1.63382000000000,1.62168000000000,1.61771000000000,1.83455000000000,1.85368000000000,2.34102000000000,2.35919000000000,3.75833000000000,3.75998000000000,4.02287000000000,4.02315000000000,4.17556000000000,4.21564000000000,4.45427000000000,5.65114000000000,5.41852000000000,3.92041000000000,3.69497000000000,3.69533000000000,3.69381000000000,0.689706000000000,0.437282000000000;1.51663000000000,1.53867000000000,1.61493000000000,1.62766000000000,1.63454000000000,1.63276000000000,1.63655000000000,1.63667000000000,1.61619000000000,1.61369000000000,1.83269000000000,1.85051000000000,2.34134000000000,2.35769000000000,3.71527000000000,3.71543000000000,3.95432000000000,3.95442000000000,4.09087000000000,4.12710000000000,4.34068000000000,5.41852000000000,5.65114000000000,3.85637000000000,3.64712000000000,3.64770000000000,3.64574000000000,0.686223000000000,0.438503000000000;1.51212000000000,1.53838000000000,1.59905000000000,1.62695000000000,1.63907000000000,1.63809000000000,1.63983000000000,1.63905000000000,1.62397000000000,1.61986000000000,1.85232000000000,1.87526000000000,2.39082000000000,2.40680000000000,4.01045000000000,4.01425000000000,4.43561000000000,4.43570000000000,4.89724000000000,4.82699000000000,4.49401000000000,3.92041000000000,3.85637000000000,5.65047000000000,4.75436000000000,4.75324000000000,4.75507000000000,0.693798000000000,0.459834000000000;1.51191000000000,1.53915000000000,1.59813000000000,1.61373000000000,1.62784000000000,1.62731000000000,1.62887000000000,1.62853000000000,1.61807000000000,1.61179000000000,1.84470000000000,1.86388000000000,2.35499000000000,2.37038000000000,3.84120000000000,3.84224000000000,4.11767000000000,4.11736000000000,4.35412000000000,4.30553000000000,4.11761000000000,3.69497000000000,3.64712000000000,4.75436000000000,5.65114000000000,5.63097000000000,5.63202000000000,0.697918000000000,0.464265000000000;1.51188000000000,1.53853000000000,1.59779000000000,1.61355000000000,1.62837000000000,1.62711000000000,1.62882000000000,1.62856000000000,1.61779000000000,1.61148000000000,1.84454000000000,1.86446000000000,2.35577000000000,2.37034000000000,3.84357000000000,3.84298000000000,4.11801000000000,4.11770000000000,4.35187000000000,4.30276000000000,4.11638000000000,3.69533000000000,3.64770000000000,4.75324000000000,5.63097000000000,5.65114000000000,5.62305000000000,0.697680000000000,0.464474000000000;1.51162000000000,1.53768000000000,1.59773000000000,1.61448000000000,1.62855000000000,1.62801000000000,1.62930000000000,1.62784000000000,1.61804000000000,1.61136000000000,1.84558000000000,1.86457000000000,2.35613000000000,2.37056000000000,3.84033000000000,3.84130000000000,4.11541000000000,4.11523000000000,4.35133000000000,4.30324000000000,4.11306000000000,3.69381000000000,3.64574000000000,4.75507000000000,5.63202000000000,5.62305000000000,5.65114000000000,0.698022000000000,0.464517000000000;0.735355000000000,0.741438000000000,0.724464000000000,0.721329000000000,0.729622000000000,0.728769000000000,0.729930000000000,0.729294000000000,0.721662000000000,0.722599000000000,0.702595000000000,0.703480000000000,0.707821000000000,0.709010000000000,0.694939000000000,0.695021000000000,0.690858000000000,0.690856000000000,0.690640000000000,0.691116000000000,0.693754000000000,0.689706000000000,0.686223000000000,0.693798000000000,0.697918000000000,0.697680000000000,0.698022000000000,5.65114000000000,1.88428000000000;0.506004000000000,0.499054000000000,0.508970000000000,0.487952000000000,0.482433000000000,0.482378000000000,0.484539000000000,0.483505000000000,0.478007000000000,0.478723000000000,0.473050000000000,0.470188000000000,0.463004000000000,0.458832000000000,0.457697000000000,0.457361000000000,0.453727000000000,0.453743000000000,0.455137000000000,0.454098000000000,0.452012000000000,0.437282000000000,0.438503000000000,0.459834000000000,0.464265000000000,0.464474000000000,0.464517000000000,1.88428000000000,5.65114000000000];
%R= [5.65114000000000,4.97361000000000,3.86648000000000,3.81375000000000,3.79818000000000,2.44166000000000,2.44426000000000,2.32761000000000,0.432735000000000,0.395416000000000,1.59396000000000,1.55063000000000,1.04030000000000,1.04141000000000,0.894813000000000,0.250536000000000,0.285749000000000,0.286441000000000,0.267272000000000,0.271693000000000,0.284605000000000,0.276723000000000,0.280477000000000,0.286985000000000,0.308952000000000,0.307678000000000,0.309340000000000,0.187497000000000,0.118990000000000;4.97377000000000,5.65114000000000,4.07988000000000,4.01209000000000,3.99353000000000,2.61294000000000,2.61257000000000,2.47975000000000,0.436745000000000,0.393273000000000,1.62156000000000,1.57600000000000,1.05123000000000,1.05207000000000,0.899270000000000,0.254695000000000,0.283637000000000,0.284537000000000,0.264577000000000,0.270141000000000,0.282058000000000,0.277981000000000,0.279221000000000,0.280672000000000,0.300750000000000,0.300031000000000,0.300801000000000,0.177034000000000,0.117632000000000;3.86681000000000,4.07988000000000,5.65114000000000,5.23449000000000,5.09373000000000,3.34213000000000,3.34477000000000,2.91952000000000,0.442131000000000,0.408637000000000,1.71125000000000,1.64907000000000,1.06986000000000,1.06869000000000,0.905229000000000,0.270689000000000,0.272095000000000,0.272491000000000,0.262308000000000,0.263266000000000,0.269536000000000,0.271177000000000,0.267287000000000,0.264026000000000,0.297913000000000,0.297350000000000,0.298005000000000,0.178662000000000,0.108486000000000;3.81375000000000,4.01209000000000,5.23449000000000,5.65114000000000,5.45348000000000,3.42110000000000,3.42391000000000,2.94311000000000,0.441646000000000,0.411648000000000,1.71210000000000,1.64593000000000,1.06533000000000,1.06410000000000,0.898152000000000,0.267863000000000,0.270813000000000,0.270912000000000,0.263854000000000,0.265586000000000,0.272852000000000,0.271850000000000,0.266751000000000,0.267340000000000,0.303064000000000,0.301799000000000,0.303019000000000,0.173211000000000,0.104753000000000;3.79808000000000,3.99353000000000,5.09373000000000,5.45348000000000,5.65114000000000,3.43116000000000,3.43421000000000,2.94449000000000,0.441636000000000,0.411794000000000,1.71193000000000,1.64737000000000,1.06548000000000,1.06266000000000,0.897328000000000,0.266994000000000,0.272120000000000,0.272613000000000,0.265632000000000,0.267595000000000,0.274226000000000,0.272793000000000,0.269543000000000,0.270084000000000,0.304266000000000,0.304052000000000,0.304278000000000,0.172771000000000,0.102059000000000;2.44166000000000,2.61294000000000,3.34213000000000,3.42110000000000,3.43116000000000,5.65114000000000,4.53717000000000,3.08487000000000,0.447536000000000,0.413191000000000,1.31715000000000,1.26119000000000,0.686756000000000,0.683653000000000,0.509015000000000,0.0886090000000000,0.0575117000000000,0.0572883000000000,0.0317151000000000,0.0287484000000000,0.0389191000000000,0.0366127000000000,0.0336256000000000,0.0471481000000000,0.0485314000000000,0.0495607000000000,0.0487906000000000,0.0245588000000000,0.00531326000000000;2.44426000000000,2.61250000000000,3.34477000000000,3.42391000000000,3.43413000000000,4.53717000000000,5.65114000000000,3.19577000000000,0.442267000000000,0.410296000000000,1.34177000000000,1.28102000000000,0.695070000000000,0.693647000000000,0.514447000000000,0.0876821000000000,0.0563986000000000,0.0565028000000000,0.0327160000000000,0.0299519000000000,0.0383468000000000,0.0383030000000000,0.0359907000000000,0.0576779000000000,0.0570318000000000,0.0569324000000000,0.0571969000000000,0.0267725000000000,0.00654612000000000;2.32770000000000,2.47975000000000,2.91952000000000,2.94302000000000,2.94449000000000,3.08487000000000,3.19577000000000,5.65114000000000,0.490777000000000,0.444338000000000,1.27412000000000,1.21289000000000,0.655288000000000,0.653952000000000,0.479495000000000,0.0368157000000000,0.0525335000000000,0.0526876000000000,0.0407404000000000,0.0340991000000000,0.0386038000000000,0.0331235000000000,0.0307715000000000,0.0367516000000000,0.0374963000000000,0.0363893000000000,0.0374833000000000,0.0260514000000000,0.0142090000000000;0.432719000000000,0.436788000000000,0.442131000000000,0.441646000000000,0.441636000000000,0.447536000000000,0.442267000000000,0.490777000000000,5.65114000000000,3.04098000000000,0.380971000000000,0.370609000000000,0.219987000000000,0.214065000000000,0.260515000000000,0.0150076000000000,0.103101000000000,0.103335000000000,0.0557914000000000,0.0501034000000000,0.0507359000000000,0.0735300000000000,0.0729787000000000,0.0605066000000000,0.0566151000000000,0.0568191000000000,0.0565429000000000,0.0391213000000000,0.0243045000000000;0.395416000000000,0.393273000000000,0.408637000000000,0.411648000000000,0.411794000000000,0.413191000000000,0.410296000000000,0.444338000000000,3.04098000000000,5.65114000000000,0.344053000000000,0.331779000000000,0.235925000000000,0.236193000000000,0.215992000000000,0.00302485000000000,0.0518359000000000,0.0518583000000000,0.0463064000000000,0.0449352000000000,0.0448013000000000,0.0628914000000000,0.0629397000000000,0.0668401000000000,0.0396580000000000,0.0396247000000000,0.0396633000000000,0.0258875000000000,0.0225942000000000;1.59400000000000,1.62156000000000,1.71125000000000,1.71210000000000,1.71193000000000,1.31715000000000,1.34177000000000,1.27412000000000,0.380971000000000,0.344053000000000,5.65114000000000,3.91309000000000,1.22089000000000,1.21077000000000,0.812517000000000,0.149931000000000,0.162691000000000,0.162369000000000,0.128096000000000,0.127488000000000,0.115083000000000,0.121707000000000,0.119486000000000,0.138415000000000,0.165089000000000,0.165745000000000,0.165217000000000,0.0850380000000000,0.0408691000000000;1.55063000000000,1.57600000000000,1.64907000000000,1.64593000000000,1.64737000000000,1.26119000000000,1.28102000000000,1.21289000000000,0.370609000000000,0.331779000000000,3.91309000000000,5.65114000000000,1.27623000000000,1.26265000000000,0.841498000000000,0.164913000000000,0.181580000000000,0.182147000000000,0.159806000000000,0.165694000000000,0.144614000000000,0.138676000000000,0.137850000000000,0.179549000000000,0.192501000000000,0.193343000000000,0.192710000000000,0.0974128000000000,0.0592163000000000;1.04027000000000,1.05123000000000,1.06995000000000,1.06533000000000,1.06548000000000,0.686756000000000,0.695070000000000,0.655288000000000,0.219987000000000,0.235925000000000,1.22089000000000,1.27623000000000,5.65114000000000,4.88021000000000,1.68693000000000,0.556913000000000,0.493755000000000,0.494288000000000,0.474546000000000,0.475112000000000,0.447455000000000,0.496252000000000,0.507964000000000,0.494872000000000,0.529681000000000,0.527015000000000,0.530442000000000,0.134598000000000,0.0985543000000000;1.04148000000000,1.05210000000000,1.06869000000000,1.06410000000000,1.06266000000000,0.683653000000000,0.693647000000000,0.653952000000000,0.214065000000000,0.236193000000000,1.21077000000000,1.26265000000000,4.88021000000000,5.65114000000000,1.70695000000000,0.571391000000000,0.506830000000000,0.508119000000000,0.484018000000000,0.481810000000000,0.452603000000000,0.509106000000000,0.516832000000000,0.502536000000000,0.548746000000000,0.546511000000000,0.549353000000000,0.142272000000000,0.0993416000000000;0.894827000000000,0.899270000000000,0.905229000000000,0.898152000000000,0.897328000000000,0.508991000000000,0.514447000000000,0.479495000000000,0.260515000000000,0.215992000000000,0.812517000000000,0.841498000000000,1.68693000000000,1.70693000000000,5.65114000000000,3.29320000000000,2.26462000000000,2.26278000000000,1.64791000000000,1.63563000000000,1.58705000000000,1.44717000000000,1.41792000000000,1.61695000000000,1.50950000000000,1.50882000000000,1.50915000000000,0.280028000000000,0.0997846000000000;0.250536000000000,0.254695000000000,0.270689000000000,0.267863000000000,0.266994000000000,0.0885894000000000,0.0876821000000000,0.0368898000000000,0.0150076000000000,0.00302485000000000,0.149931000000000,0.164913000000000,0.556913000000000,0.571391000000000,3.29320000000000,5.65114000000000,2.01707000000000,2.01898000000000,1.31068000000000,1.29600000000000,1.23793000000000,1.09985000000000,1.08365000000000,1.27222000000000,1.27036000000000,1.27043000000000,1.27000000000000,0.217466000000000,0.0674804000000000;0.285779000000000,0.283637000000000,0.272095000000000,0.270813000000000,0.272120000000000,0.0575117000000000,0.0563986000000000,0.0525335000000000,0.103101000000000,0.0518359000000000,0.162691000000000,0.181580000000000,0.493755000000000,0.506830000000000,2.26462000000000,2.01707000000000,5.65114000000000,5.60602000000000,1.98227000000000,1.94260000000000,1.78955000000000,1.51418000000000,1.47516000000000,1.89842000000000,1.73306000000000,1.73569000000000,1.73266000000000,0.229894000000000,0.107352000000000;0.286441000000000,0.284550000000000,0.272491000000000,0.270912000000000,0.272613000000000,0.0572883000000000,0.0565028000000000,0.0526876000000000,0.103335000000000,0.0518583000000000,0.162369000000000,0.182147000000000,0.494288000000000,0.508119000000000,2.26278000000000,2.01898000000000,5.60602000000000,5.65114000000000,1.98288000000000,1.94310000000000,1.79088000000000,1.51425000000000,1.47489000000000,1.89631000000000,1.73426000000000,1.73635000000000,1.73429000000000,0.230289000000000,0.107626000000000;0.267272000000000,0.264577000000000,0.262308000000000,0.263854000000000,0.265632000000000,0.0317151000000000,0.0327160000000000,0.0407404000000000,0.0557914000000000,0.0463064000000000,0.128096000000000,0.159806000000000,0.474546000000000,0.484018000000000,1.64791000000000,1.31068000000000,1.98227000000000,1.98288000000000,5.65114000000000,4.71852000000000,3.27638000000000,2.26805000000000,2.17168000000000,3.45595000000000,2.67976000000000,2.68140000000000,2.67976000000000,0.200712000000000,0.0774640000000000;0.271693000000000,0.270141000000000,0.263247000000000,0.265586000000000,0.267595000000000,0.0287484000000000,0.0299519000000000,0.0340991000000000,0.0501034000000000,0.0449352000000000,0.127488000000000,0.165694000000000,0.475112000000000,0.481810000000000,1.63563000000000,1.29600000000000,1.94260000000000,1.94310000000000,4.71852000000000,5.65114000000000,3.44728000000000,2.32649000000000,2.22722000000000,3.34847000000000,2.65147000000000,2.65179000000000,2.65173000000000,0.200657000000000,0.0895146000000000;0.284584000000000,0.282058000000000,0.269536000000000,0.272852000000000,0.274226000000000,0.0389191000000000,0.0383468000000000,0.0386038000000000,0.0507359000000000,0.0448013000000000,0.115083000000000,0.144614000000000,0.447455000000000,0.452603000000000,1.58705000000000,1.23793000000000,1.78955000000000,1.79088000000000,3.27638000000000,3.44728000000000,5.65114000000000,2.64323000000000,2.51983000000000,2.89586000000000,2.44172000000000,2.44485000000000,2.44180000000000,0.204567000000000,0.109857000000000;0.276662000000000,0.277984000000000,0.271177000000000,0.271850000000000,0.272793000000000,0.0366127000000000,0.0383030000000000,0.0331235000000000,0.0735300000000000,0.0628914000000000,0.121690000000000,0.138676000000000,0.496252000000000,0.509106000000000,1.44717000000000,1.09985000000000,1.51418000000000,1.51425000000000,2.26805000000000,2.32649000000000,2.64323000000000,5.65114000000000,4.38120000000000,2.14292000000000,1.96426000000000,1.96362000000000,1.96438000000000,0.214613000000000,0.113964000000000;0.280406000000000,0.279221000000000,0.267287000000000,0.266751000000000,0.269543000000000,0.0336256000000000,0.0359907000000000,0.0307715000000000,0.0729787000000000,0.0629397000000000,0.119486000000000,0.137850000000000,0.507964000000000,0.516832000000000,1.41792000000000,1.08365000000000,1.47516000000000,1.47489000000000,2.17168000000000,2.22722000000000,2.51983000000000,4.38120000000000,5.65114000000000,2.06940000000000,1.90999000000000,1.90953000000000,1.90995000000000,0.217764000000000,0.117614000000000;0.287075000000000,0.280672000000000,0.264026000000000,0.267340000000000,0.270084000000000,0.0471481000000000,0.0576779000000000,0.0367615000000000,0.0605066000000000,0.0668401000000000,0.138415000000000,0.179549000000000,0.494872000000000,0.502586000000000,1.61699000000000,1.27222000000000,1.89842000000000,1.89631000000000,3.45609000000000,3.34847000000000,2.89586000000000,2.14292000000000,2.06932000000000,5.65089000000000,3.25236000000000,3.25528000000000,3.25247000000000,0.200093000000000,0.0994395000000000;0.308952000000000,0.300753000000000,0.297913000000000,0.303064000000000,0.304266000000000,0.0485314000000000,0.0570318000000000,0.0374963000000000,0.0566151000000000,0.0396384000000000,0.165089000000000,0.192501000000000,0.529681000000000,0.548746000000000,1.50945000000000,1.27036000000000,1.73306000000000,1.73426000000000,2.67976000000000,2.65147000000000,2.44172000000000,1.96426000000000,1.90999000000000,3.25267000000000,5.65114000000000,5.49219000000000,5.64055000000000,0.188426000000000,0.105950000000000;0.307678000000000,0.300027000000000,0.297350000000000,0.301799000000000,0.304052000000000,0.0495607000000000,0.0569324000000000,0.0363893000000000,0.0568191000000000,0.0396247000000000,0.165745000000000,0.193343000000000,0.527015000000000,0.546511000000000,1.50882000000000,1.27043000000000,1.73569000000000,1.73635000000000,2.68140000000000,2.65179000000000,2.44485000000000,1.96362000000000,1.90953000000000,3.25528000000000,5.49219000000000,5.65114000000000,5.49506000000000,0.187636000000000,0.104471000000000;0.309460000000000,0.300814000000000,0.298005000000000,0.303019000000000,0.304278000000000,0.0487906000000000,0.0571969000000000,0.0374833000000000,0.0565429000000000,0.0396633000000000,0.165217000000000,0.192710000000000,0.530442000000000,0.549353000000000,1.50915000000000,1.27000000000000,1.73266000000000,1.73429000000000,2.67976000000000,2.65173000000000,2.44180000000000,1.96438000000000,1.90995000000000,3.25278000000000,5.64055000000000,5.49506000000000,5.65114000000000,0.188615000000000,0.105967000000000;0.187497000000000,0.177034000000000,0.178662000000000,0.173211000000000,0.172771000000000,0.0245588000000000,0.0267725000000000,0.0260514000000000,0.0391213000000000,0.0258875000000000,0.0850380000000000,0.0974128000000000,0.134598000000000,0.142272000000000,0.280028000000000,0.217466000000000,0.229894000000000,0.230289000000000,0.200712000000000,0.200657000000000,0.204567000000000,0.214613000000000,0.217764000000000,0.200113000000000,0.188426000000000,0.187636000000000,0.188615000000000,5.65114000000000,1.38763000000000;0.118990000000000,0.117600000000000,0.108486000000000,0.104753000000000,0.102059000000000,0.00531326000000000,0.00654612000000000,0.0142090000000000,0.0243045000000000,0.0225942000000000,0.0408691000000000,0.0592163000000000,0.0985543000000000,0.0993416000000000,0.0997846000000000,0.0674804000000000,0.107352000000000,0.107626000000000,0.0774640000000000,0.0895146000000000,0.109857000000000,0.113964000000000,0.117614000000000,0.0994401000000000,0.105950000000000,0.104471000000000,0.105967000000000,1.38763000000000,5.65114000000000];
Hierarchical_results = linkage(R,'average');
inconsistency_R = inconsistent(Hierarchical_results);
T = cluster(Hierarchical_results,'cutoff',abs(max(inconsistency_R(:,4))-(10^(-15))));
%heatmap(R,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)

% Z = linkage(D);
% I = inconsistent(Z);
% T = cluster(Z,'cutoff',abs(max(I(:,4))-(10^(-15))));
Tmax = max(T);

figure
dendrogram(Hierarchical_results,'ColorThreshold','default')
xticklabels(target_phase_names_voltages);
xtickangle(90)


%############feature selection using neighborhood component analysis#########
% counter = 1;
% for i = target_phase_mag_voltage
%     mdl = fsrnca([R_input_voltage(:,[target_phase_mag_voltage,target_phase_ang_voltage]),R_input_current(:,[target_phase_mag_current,target_phase_ang_current])],R_input_voltage(:,i),'Standardize',true);
%     [PMU_weight(counter,1), PMU_loc(counter,1)] = max(mdl.FeatureWeights);
%     counter = counter + 1;
% end
%###########################################################################




MI_voltMag = [5.65080000000000,4.99691000000000,3.87682000000000,3.81831000000000,3.77438000000000,1.98435000000000,1.97827000000000,1.91632000000000,0.301494000000000,0.284831000000000,1.13210000000000,1.10186000000000,0.748541000000000,0.749975000000000,0.645744000000000,0.204875000000000,0.187748000000000,0.188086000000000,0.154695000000000,0.153476000000000,0.136593000000000,0.130622000000000,0.131143000000000,0.152003000000000,0.156415000000000,0.158106000000000,0.156184000000000,0.202149000000000,0.206953000000000;4.99716000000000,5.65114000000000,4.08145000000000,3.99974000000000,3.94254000000000,2.11458000000000,2.10480000000000,2.06004000000000,0.310342000000000,0.292089000000000,1.16137000000000,1.13238000000000,0.757950000000000,0.760988000000000,0.653101000000000,0.209400000000000,0.195607000000000,0.196090000000000,0.157392000000000,0.153695000000000,0.131213000000000,0.125919000000000,0.127383000000000,0.154764000000000,0.162677000000000,0.164470000000000,0.162743000000000,0.201649000000000,0.203779000000000;3.87682000000000,4.08145000000000,5.65114000000000,5.09210000000000,4.83214000000000,2.60029000000000,2.60105000000000,2.49302000000000,0.318145000000000,0.306803000000000,1.25966000000000,1.22725000000000,0.790337000000000,0.792376000000000,0.685755000000000,0.207760000000000,0.193114000000000,0.193389000000000,0.156994000000000,0.153495000000000,0.121355000000000,0.123675000000000,0.123939000000000,0.164357000000000,0.174510000000000,0.176380000000000,0.174043000000000,0.207209000000000,0.188928000000000;3.81817000000000,3.99982000000000,5.09210000000000,5.65114000000000,5.25421000000000,2.70795000000000,2.70443000000000,2.46158000000000,0.310699000000000,0.298832000000000,1.29509000000000,1.25998000000000,0.807536000000000,0.808709000000000,0.697031000000000,0.205811000000000,0.193714000000000,0.193321000000000,0.155566000000000,0.152657000000000,0.120273000000000,0.125599000000000,0.127264000000000,0.165925000000000,0.173042000000000,0.175384000000000,0.172675000000000,0.207428000000000,0.187457000000000;3.77438000000000,3.94248000000000,4.83214000000000,5.25421000000000,5.65114000000000,2.71573000000000,2.71337000000000,2.39934000000000,0.305400000000000,0.293798000000000,1.32523000000000,1.28732000000000,0.818815000000000,0.818078000000000,0.703760000000000,0.205644000000000,0.191612000000000,0.191812000000000,0.155525000000000,0.152662000000000,0.121268000000000,0.127094000000000,0.129495000000000,0.166242000000000,0.173994000000000,0.176625000000000,0.173900000000000,0.205995000000000,0.185754000000000;1.98435000000000,2.11458000000000,2.60029000000000,2.70795000000000,2.71573000000000,5.65114000000000,4.32498000000000,2.71464000000000,0.167705000000000,0.147268000000000,1.00407000000000,0.946294000000000,0.383647000000000,0.383603000000000,0.244121000000000,0.197088000000000,0.202380000000000,0.202891000000000,0.169896000000000,0.177581000000000,0.164782000000000,0.171608000000000,0.172124000000000,0.167809000000000,0.183270000000000,0.185490000000000,0.183012000000000,0.000962286000000000,0.0853506000000000;1.97827000000000,2.10480000000000,2.60105000000000,2.70443000000000,2.71337000000000,4.32498000000000,5.65114000000000,2.82786000000000,0.178430000000000,0.153897000000000,1.02046000000000,0.961120000000000,0.387120000000000,0.385046000000000,0.249807000000000,0.195285000000000,0.201392000000000,0.202628000000000,0.193407000000000,0.199312000000000,0.163599000000000,0.163400000000000,0.164820000000000,0.185269000000000,0.191478000000000,0.194486000000000,0.191864000000000,0,0.0922577000000000;1.91632000000000,2.06004000000000,2.49302000000000,2.46158000000000,2.39934000000000,2.71464000000000,2.82786000000000,5.65114000000000,0.202192000000000,0.166434000000000,0.969511000000000,0.905648000000000,0.417827000000000,0.417694000000000,0.292663000000000,0.210227000000000,0.185119000000000,0.185650000000000,0.218933000000000,0.218461000000000,0.205620000000000,0.223042000000000,0.222372000000000,0.208996000000000,0.208587000000000,0.207385000000000,0.208553000000000,0.0106812000000000,0.0489568000000000;0.301494000000000,0.310327000000000,0.318145000000000,0.310699000000000,0.305400000000000,0.167682000000000,0.178430000000000,0.202192000000000,5.65114000000000,2.92639000000000,0.253829000000000,0.271342000000000,0.164605000000000,0.159076000000000,0.126570000000000,0.0191409000000000,0.0763647000000000,0.0763520000000000,0.0792133000000000,0.0753042000000000,0.0501983000000000,0.0594502000000000,0.0605217000000000,0.0617065000000000,0.0576184000000000,0.0562839000000000,0.0569485000000000,0.00742240000000000,0.0156777000000000;0.284831000000000,0.292089000000000,0.306803000000000,0.298832000000000,0.293798000000000,0.147268000000000,0.153927000000000,0.166434000000000,2.92639000000000,5.65114000000000,0.209918000000000,0.221776000000000,0.171960000000000,0.158493000000000,0.130083000000000,0.00915241000000000,0.0709665000000000,0.0719493000000000,0.0684731000000000,0.0685488000000000,0.0609631000000000,0.0538974000000000,0.0534507000000000,0.0593257000000000,0.0701368000000000,0.0716637000000000,0.0701596000000000,0.0178493000000000,0;1.13213000000000,1.16140000000000,1.25966000000000,1.29509000000000,1.32523000000000,1.00407000000000,1.02046000000000,0.969511000000000,0.253829000000000,0.209918000000000,5.65114000000000,3.35973000000000,0.739630000000000,0.733494000000000,0.355227000000000,0.173827000000000,0.192044000000000,0.191726000000000,0.180189000000000,0.188650000000000,0.212069000000000,0.220720000000000,0.219489000000000,0.186628000000000,0.206371000000000,0.206715000000000,0.206080000000000,0.0235534000000000,0.0585127000000000;1.10188000000000,1.13239000000000,1.22725000000000,1.25998000000000,1.28729000000000,0.946294000000000,0.961120000000000,0.905648000000000,0.271342000000000,0.221776000000000,3.35973000000000,5.65114000000000,0.796713000000000,0.788553000000000,0.384105000000000,0.177214000000000,0.167181000000000,0.167799000000000,0.169758000000000,0.166438000000000,0.173508000000000,0.175924000000000,0.178460000000000,0.180341000000000,0.184207000000000,0.185272000000000,0.183965000000000,0.0327474000000000,0.0587329000000000;0.748557000000000,0.757950000000000,0.790337000000000,0.807536000000000,0.818815000000000,0.383647000000000,0.387120000000000,0.417827000000000,0.164605000000000,0.171960000000000,0.739650000000000,0.796692000000000,5.65114000000000,4.52597000000000,1.24975000000000,0.253374000000000,0.179983000000000,0.180459000000000,0.115559000000000,0.112714000000000,0.116867000000000,0.122695000000000,0.118847000000000,0.109638000000000,0.105403000000000,0.104832000000000,0.105784000000000,0.148686000000000,0.178266000000000;0.749975000000000,0.760988000000000,0.792376000000000,0.808709000000000,0.818078000000000,0.383603000000000,0.385046000000000,0.417694000000000,0.159062000000000,0.158493000000000,0.733494000000000,0.788553000000000,4.52597000000000,5.65114000000000,1.27381000000000,0.261913000000000,0.188723000000000,0.189169000000000,0.140399000000000,0.133899000000000,0.131204000000000,0.135441000000000,0.132345000000000,0.125855000000000,0.120879000000000,0.119870000000000,0.121176000000000,0.151890000000000,0.189010000000000;0.645744000000000,0.653119000000000,0.685755000000000,0.697031000000000,0.703760000000000,0.244121000000000,0.249807000000000,0.292663000000000,0.126570000000000,0.130083000000000,0.355227000000000,0.384105000000000,1.24975000000000,1.27381000000000,5.65114000000000,3.09295000000000,1.89433000000000,1.89649000000000,1.24290000000000,1.21531000000000,1.11124000000000,1.12088000000000,1.12633000000000,1.26026000000000,1.25613000000000,1.25173000000000,1.25580000000000,0.234009000000000,0.279220000000000;0.204875000000000,0.209400000000000,0.207760000000000,0.205811000000000,0.205644000000000,0.197088000000000,0.195285000000000,0.210227000000000,0.0191409000000000,0.00915241000000000,0.173827000000000,0.177214000000000,0.253374000000000,0.261913000000000,3.09295000000000,5.65114000000000,2.17040000000000,2.17198000000000,1.36335000000000,1.34035000000000,1.24199000000000,1.26546000000000,1.26581000000000,1.33450000000000,1.34019000000000,1.34123000000000,1.33988000000000,0.0638927000000000,0.0306762000000000;0.187748000000000,0.195594000000000,0.193114000000000,0.193714000000000,0.191612000000000,0.202380000000000,0.201392000000000,0.185119000000000,0.0763647000000000,0.0709665000000000,0.192044000000000,0.167181000000000,0.179983000000000,0.188723000000000,1.89433000000000,2.17040000000000,5.65114000000000,5.59309000000000,1.92720000000000,1.88406000000000,1.71299000000000,1.71354000000000,1.71090000000000,1.88683000000000,1.88224000000000,1.88844000000000,1.88232000000000,0.0911260000000000,0.0621146000000000;0.188086000000000,0.196090000000000,0.193389000000000,0.193321000000000,0.191812000000000,0.202891000000000,0.202628000000000,0.185650000000000,0.0763520000000000,0.0719493000000000,0.191726000000000,0.167799000000000,0.180459000000000,0.189169000000000,1.89649000000000,2.17198000000000,5.59309000000000,5.65114000000000,1.92897000000000,1.88541000000000,1.71534000000000,1.71562000000000,1.71287000000000,1.88794000000000,1.88473000000000,1.88951000000000,1.88434000000000,0.0908118000000000,0.0620309000000000;0.154695000000000,0.157392000000000,0.156975000000000,0.155545000000000,0.155525000000000,0.169896000000000,0.193407000000000,0.218933000000000,0.0792133000000000,0.0684731000000000,0.180206000000000,0.169758000000000,0.115559000000000,0.140399000000000,1.24290000000000,1.36335000000000,1.92720000000000,1.92897000000000,5.65114000000000,4.74270000000000,3.24962000000000,3.19000000000000,3.17411000000000,4.17846000000000,3.91616000000000,3.88226000000000,3.91631000000000,0.0966515000000000,0.0416900000000000;0.153476000000000,0.153695000000000,0.153455000000000,0.152657000000000,0.152662000000000,0.177581000000000,0.199312000000000,0.218461000000000,0.0753042000000000,0.0685488000000000,0.188650000000000,0.166438000000000,0.112714000000000,0.133899000000000,1.21531000000000,1.34035000000000,1.88406000000000,1.88541000000000,4.74270000000000,5.65114000000000,3.41716000000000,3.34485000000000,3.32280000000000,4.09310000000000,3.86090000000000,3.84241000000000,3.86030000000000,0.0888979000000000,0.0356202000000000;0.136593000000000,0.131213000000000,0.121355000000000,0.120273000000000,0.121268000000000,0.164782000000000,0.163599000000000,0.205620000000000,0.0501983000000000,0.0609631000000000,0.212069000000000,0.173508000000000,0.116867000000000,0.131204000000000,1.11124000000000,1.24199000000000,1.71299000000000,1.71534000000000,3.24962000000000,3.41716000000000,5.65114000000000,4.33472000000000,4.22642000000000,3.19587000000000,3.14988000000000,3.13912000000000,3.14855000000000,0.0839843000000000,0.0307852000000000;0.130622000000000,0.125919000000000,0.123675000000000,0.125599000000000,0.127094000000000,0.171608000000000,0.163400000000000,0.223042000000000,0.0594502000000000,0.0538974000000000,0.220720000000000,0.175924000000000,0.122695000000000,0.135441000000000,1.12088000000000,1.26546000000000,1.71354000000000,1.71562000000000,3.19000000000000,3.34485000000000,4.33472000000000,5.65114000000000,5.36546000000000,3.13685000000000,3.09576000000000,3.09124000000000,3.09468000000000,0.0665505000000000,0.0293884000000000;0.131157000000000,0.127383000000000,0.123939000000000,0.127264000000000,0.129511000000000,0.172124000000000,0.164845000000000,0.222372000000000,0.0604814000000000,0.0534507000000000,0.219489000000000,0.178460000000000,0.118847000000000,0.132345000000000,1.12633000000000,1.26581000000000,1.71087000000000,1.71287000000000,3.17411000000000,3.32280000000000,4.22642000000000,5.36546000000000,5.65064000000000,3.11792000000000,3.07678000000000,3.07010000000000,3.07614000000000,0.0626111000000000,0.0288470000000000;0.152003000000000,0.154778000000000,0.164338000000000,0.165925000000000,0.166259000000000,0.167832000000000,0.185269000000000,0.208996000000000,0.0617065000000000,0.0593257000000000,0.186630000000000,0.180343000000000,0.109642000000000,0.125855000000000,1.26026000000000,1.33450000000000,1.88683000000000,1.88794000000000,4.17846000000000,4.09310000000000,3.19587000000000,3.13685000000000,3.11792000000000,5.64989000000000,4.65658000000000,4.55974000000000,4.65571000000000,0.106874000000000,0.0470940000000000;0.156415000000000,0.162677000000000,0.174515000000000,0.173042000000000,0.173994000000000,0.183270000000000,0.191478000000000,0.208614000000000,0.0575991000000000,0.0701368000000000,0.206371000000000,0.184207000000000,0.105403000000000,0.120864000000000,1.25613000000000,1.34019000000000,1.88224000000000,1.88473000000000,3.91616000000000,3.86090000000000,3.14988000000000,3.09576000000000,3.07678000000000,4.65621000000000,5.65114000000000,5.39441000000000,5.63464000000000,0.110435000000000,0.0443509000000000;0.158106000000000,0.164470000000000,0.176361000000000,0.175384000000000,0.176625000000000,0.185490000000000,0.194486000000000,0.207385000000000,0.0562839000000000,0.0716776000000000,0.206715000000000,0.185272000000000,0.104832000000000,0.119870000000000,1.25173000000000,1.34123000000000,1.88844000000000,1.88947000000000,3.88226000000000,3.84241000000000,3.13912000000000,3.09124000000000,3.07010000000000,4.55974000000000,5.39441000000000,5.65114000000000,5.39524000000000,0.109477000000000,0.0445678000000000;0.156184000000000,0.162743000000000,0.174024000000000,0.172675000000000,0.173900000000000,0.183012000000000,0.191864000000000,0.208553000000000,0.0569485000000000,0.0701596000000000,0.206051000000000,0.183965000000000,0.105784000000000,0.121176000000000,1.25580000000000,1.33988000000000,1.88232000000000,1.88434000000000,3.91631000000000,3.86030000000000,3.14855000000000,3.09468000000000,3.07614000000000,4.65571000000000,5.63464000000000,5.39524000000000,5.65114000000000,0.110689000000000,0.0445968000000000;0.202149000000000,0.201649000000000,0.207209000000000,0.207428000000000,0.205979000000000,0.000962286000000000,0,0.0106812000000000,0.00742240000000000,0.0178493000000000,0.0235180000000000,0.0327474000000000,0.148705000000000,0.151890000000000,0.234009000000000,0.0638927000000000,0.0911260000000000,0.0908118000000000,0.0966515000000000,0.0888979000000000,0.0839843000000000,0.0665505000000000,0.0626111000000000,0.106853000000000,0.110435000000000,0.109477000000000,0.110689000000000,5.65114000000000,1.42131000000000;0.206953000000000,0.203771000000000,0.188928000000000,0.187457000000000,0.185754000000000,0.0853506000000000,0.0922577000000000,0.0489568000000000,0.0156777000000000,0,0.0585127000000000,0.0587329000000000,0.178266000000000,0.189010000000000,0.279220000000000,0.0306762000000000,0.0621146000000000,0.0620309000000000,0.0416900000000000,0.0356202000000000,0.0307852000000000,0.0293884000000000,0.0288470000000000,0.0470940000000000,0.0443509000000000,0.0445678000000000,0.0445968000000000,1.42131000000000,5.65114000000000];
heatmap(MI_voltMag,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_voltages];
ax.YData =[target_phase_names_voltages];
title ('VoltageMag')

figure
MI_voltAng =[5.65114000000000,3.44796000000000,1.95567000000000,1.68894000000000,1.56029000000000,1.55973000000000,1.55962000000000,1.55933000000000,1.56094000000000,1.55677000000000,1.72483000000000,1.73684000000000,1.62945000000000,1.62267000000000,1.01170000000000,1.01333000000000,0.942644000000000,0.942770000000000,0.868959000000000,0.867690000000000,0.860757000000000,0.859775000000000,0.858158000000000,0.862698000000000,0.859030000000000,0.859959000000000,0.858669000000000,0.301482000000000,0.217734000000000;3.44796000000000,5.65114000000000,2.19850000000000,1.79313000000000,1.63825000000000,1.63507000000000,1.64030000000000,1.64194000000000,1.62925000000000,1.62598000000000,1.90045000000000,1.91758000000000,1.75580000000000,1.74213000000000,0.999326000000000,0.998491000000000,0.939605000000000,0.939584000000000,0.890804000000000,0.889164000000000,0.880776000000000,0.886679000000000,0.886371000000000,0.885680000000000,0.886935000000000,0.885868000000000,0.886559000000000,0.270460000000000,0.239052000000000;1.95567000000000,2.19850000000000,5.65114000000000,2.60143000000000,2.10238000000000,2.09549000000000,2.11237000000000,2.11143000000000,2.08806000000000,2.08473000000000,2.69458000000000,2.73435000000000,1.86130000000000,1.84177000000000,0.976111000000000,0.975616000000000,0.924065000000000,0.924068000000000,0.877098000000000,0.876499000000000,0.876732000000000,0.870341000000000,0.869120000000000,0.866270000000000,0.870626000000000,0.871644000000000,0.872014000000000,0.348713000000000,0.270181000000000;1.68894000000000,1.79313000000000,2.60143000000000,5.65114000000000,3.04022000000000,3.02250000000000,3.06519000000000,3.06278000000000,3.02099000000000,3.00922000000000,3.10435000000000,2.98032000000000,1.62397000000000,1.60644000000000,0.840378000000000,0.841991000000000,0.801794000000000,0.801813000000000,0.750649000000000,0.752903000000000,0.754281000000000,0.757367000000000,0.756484000000000,0.733746000000000,0.728531000000000,0.728908000000000,0.729206000000000,0.356203000000000,0.253949000000000;1.56029000000000,1.63825000000000,2.10238000000000,3.04022000000000,5.65114000000000,5.45462000000000,5.39993000000000,5.39291000000000,4.68457000000000,4.59711000000000,2.44754000000000,2.38318000000000,1.43320000000000,1.42064000000000,0.772368000000000,0.772350000000000,0.730683000000000,0.730709000000000,0.674366000000000,0.673899000000000,0.663741000000000,0.659597000000000,0.659412000000000,0.662606000000000,0.665187000000000,0.664721000000000,0.665141000000000,0.384514000000000,0.282762000000000;1.55973000000000,1.63507000000000,2.09549000000000,3.02250000000000,5.45462000000000,5.65114000000000,5.22815000000000,5.22952000000000,4.65542000000000,4.57724000000000,2.43564000000000,2.37321000000000,1.43100000000000,1.41787000000000,0.769465000000000,0.769284000000000,0.730009000000000,0.730012000000000,0.672776000000000,0.671686000000000,0.663018000000000,0.658817000000000,0.658457000000000,0.660452000000000,0.663937000000000,0.663950000000000,0.663977000000000,0.385238000000000,0.282704000000000;1.55962000000000,1.64030000000000,2.11237000000000,3.06519000000000,5.39993000000000,5.22815000000000,5.65114000000000,5.59429000000000,4.68166000000000,4.59981000000000,2.46274000000000,2.39746000000000,1.43624000000000,1.42292000000000,0.775775000000000,0.777200000000000,0.733291000000000,0.733433000000000,0.676530000000000,0.675494000000000,0.665113000000000,0.662957000000000,0.662085000000000,0.664285000000000,0.666487000000000,0.666699000000000,0.666718000000000,0.384234000000000,0.285356000000000;1.55933000000000,1.64194000000000,2.11143000000000,3.06278000000000,5.39291000000000,5.22952000000000,5.59429000000000,5.65114000000000,4.70973000000000,4.62546000000000,2.46125000000000,2.39679000000000,1.43630000000000,1.42342000000000,0.775707000000000,0.776578000000000,0.732743000000000,0.732744000000000,0.675701000000000,0.675673000000000,0.665645000000000,0.662233000000000,0.661962000000000,0.664027000000000,0.666291000000000,0.666536000000000,0.666086000000000,0.383484000000000,0.285423000000000;1.56094000000000,1.62925000000000,2.08806000000000,3.02099000000000,4.68457000000000,4.65542000000000,4.68166000000000,4.70973000000000,5.65114000000000,5.44674000000000,2.43133000000000,2.37264000000000,1.43001000000000,1.41664000000000,0.764746000000000,0.764139000000000,0.714941000000000,0.715007000000000,0.662168000000000,0.662067000000000,0.659414000000000,0.662153000000000,0.661010000000000,0.651322000000000,0.650901000000000,0.651734000000000,0.650906000000000,0.373907000000000,0.289707000000000;1.55677000000000,1.62598000000000,2.08473000000000,3.00922000000000,4.59711000000000,4.57724000000000,4.59981000000000,4.62546000000000,5.44674000000000,5.65114000000000,2.42356000000000,2.36487000000000,1.43052000000000,1.41747000000000,0.764580000000000,0.763923000000000,0.713798000000000,0.713872000000000,0.660478000000000,0.660898000000000,0.659129000000000,0.660196000000000,0.659893000000000,0.650347000000000,0.650861000000000,0.650878000000000,0.651159000000000,0.371817000000000,0.288373000000000;1.72483000000000,1.90045000000000,2.69458000000000,3.10435000000000,2.44754000000000,2.43564000000000,2.46274000000000,2.46125000000000,2.43133000000000,2.42356000000000,5.65114000000000,4.71309000000000,1.80473000000000,1.78442000000000,0.954739000000000,0.955044000000000,0.913477000000000,0.913448000000000,0.830851000000000,0.832681000000000,0.827108000000000,0.828233000000000,0.826803000000000,0.825681000000000,0.832854000000000,0.834528000000000,0.834024000000000,0.366917000000000,0.276739000000000;1.73684000000000,1.91758000000000,2.73435000000000,2.98032000000000,2.38318000000000,2.37321000000000,2.39746000000000,2.39679000000000,2.37264000000000,2.36487000000000,4.71309000000000,5.65114000000000,1.84352000000000,1.82441000000000,0.971909000000000,0.971580000000000,0.928703000000000,0.928691000000000,0.846509000000000,0.846523000000000,0.841616000000000,0.844704000000000,0.843421000000000,0.839768000000000,0.847626000000000,0.848407000000000,0.847475000000000,0.364035000000000,0.271545000000000;1.62945000000000,1.75580000000000,1.86130000000000,1.62397000000000,1.43320000000000,1.43100000000000,1.43624000000000,1.43630000000000,1.43001000000000,1.43052000000000,1.80473000000000,1.84352000000000,5.65114000000000,5.08881000000000,1.46689000000000,1.46971000000000,1.37478000000000,1.37488000000000,1.27768000000000,1.27459000000000,1.26436000000000,1.26091000000000,1.25881000000000,1.27091000000000,1.27007000000000,1.27084000000000,1.26911000000000,0.355439000000000,0.244943000000000;1.62267000000000,1.74213000000000,1.84177000000000,1.60644000000000,1.42064000000000,1.41787000000000,1.42292000000000,1.42342000000000,1.41664000000000,1.41747000000000,1.78442000000000,1.82441000000000,5.08881000000000,5.65114000000000,1.48461000000000,1.48747000000000,1.39136000000000,1.39128000000000,1.29057000000000,1.28832000000000,1.27764000000000,1.27416000000000,1.27260000000000,1.28480000000000,1.28363000000000,1.28360000000000,1.28307000000000,0.355189000000000,0.244617000000000;1.01170000000000,0.999326000000000,0.976111000000000,0.840378000000000,0.772368000000000,0.769465000000000,0.775775000000000,0.775707000000000,0.764746000000000,0.764580000000000,0.954739000000000,0.971909000000000,1.46689000000000,1.48461000000000,5.65114000000000,5.51986000000000,3.73392000000000,3.73427000000000,2.99988000000000,2.99253000000000,2.91369000000000,2.91990000000000,2.92241000000000,2.96842000000000,2.94891000000000,2.94805000000000,2.94834000000000,0.200745000000000,0.131868000000000;1.01333000000000,0.998491000000000,0.975616000000000,0.841991000000000,0.772350000000000,0.769284000000000,0.777200000000000,0.776578000000000,0.764139000000000,0.763923000000000,0.955044000000000,0.971580000000000,1.46971000000000,1.48747000000000,5.51986000000000,5.65114000000000,3.71880000000000,3.71885000000000,2.99495000000000,2.98466000000000,2.90703000000000,2.91127000000000,2.91160000000000,2.95877000000000,2.94308000000000,2.94220000000000,2.94135000000000,0.201101000000000,0.132724000000000;0.942644000000000,0.939605000000000,0.924065000000000,0.801794000000000,0.730683000000000,0.730009000000000,0.733291000000000,0.732743000000000,0.714941000000000,0.713798000000000,0.913477000000000,0.928703000000000,1.37478000000000,1.39136000000000,3.73392000000000,3.71880000000000,5.65114000000000,5.64964000000000,3.55455000000000,3.52909000000000,3.43152000000000,3.41760000000000,3.42151000000000,3.47279000000000,3.44624000000000,3.44685000000000,3.44943000000000,0.203568000000000,0.143518000000000;0.942770000000000,0.939584000000000,0.924068000000000,0.801813000000000,0.730709000000000,0.730012000000000,0.733433000000000,0.732744000000000,0.715007000000000,0.713872000000000,0.913448000000000,0.928691000000000,1.37488000000000,1.39128000000000,3.73427000000000,3.71885000000000,5.64964000000000,5.65114000000000,3.55451000000000,3.52893000000000,3.43100000000000,3.41725000000000,3.42102000000000,3.47257000000000,3.44610000000000,3.44666000000000,3.44955000000000,0.203541000000000,0.143581000000000;0.868959000000000,0.890804000000000,0.877098000000000,0.750649000000000,0.674366000000000,0.672776000000000,0.676530000000000,0.675701000000000,0.662168000000000,0.660478000000000,0.830851000000000,0.846509000000000,1.27768000000000,1.29057000000000,2.99988000000000,2.99495000000000,3.55455000000000,3.55451000000000,5.65114000000000,5.45126000000000,4.77159000000000,4.55235000000000,4.53289000000000,4.98717000000000,4.71398000000000,4.70009000000000,4.69984000000000,0.212312000000000,0.138424000000000;0.867690000000000,0.889164000000000,0.876499000000000,0.752903000000000,0.673899000000000,0.671686000000000,0.675494000000000,0.675673000000000,0.662067000000000,0.660898000000000,0.832681000000000,0.846523000000000,1.27459000000000,1.28832000000000,2.99253000000000,2.98466000000000,3.52909000000000,3.52893000000000,5.45126000000000,5.65114000000000,4.89182000000000,4.63109000000000,4.60868000000000,4.94002000000000,4.68074000000000,4.66746000000000,4.66485000000000,0.213141000000000,0.138228000000000;0.860757000000000,0.880776000000000,0.876732000000000,0.754281000000000,0.663741000000000,0.663018000000000,0.665113000000000,0.665645000000000,0.659414000000000,0.659129000000000,0.827108000000000,0.841616000000000,1.26436000000000,1.27764000000000,2.91369000000000,2.90703000000000,3.43152000000000,3.43100000000000,4.77159000000000,4.89182000000000,5.65114000000000,5.00733000000000,4.96114000000000,4.56707000000000,4.41844000000000,4.42186000000000,4.40812000000000,0.212132000000000,0.140000000000000;0.859775000000000,0.886679000000000,0.870341000000000,0.757367000000000,0.659597000000000,0.658817000000000,0.662957000000000,0.662233000000000,0.662153000000000,0.660196000000000,0.828233000000000,0.844704000000000,1.26091000000000,1.27416000000000,2.91990000000000,2.91127000000000,3.41760000000000,3.41725000000000,4.55235000000000,4.63109000000000,5.00733000000000,5.65114000000000,5.56952000000000,4.40366000000000,4.27623000000000,4.27209000000000,4.27398000000000,0.211755000000000,0.143208000000000;0.858158000000000,0.886371000000000,0.869120000000000,0.756484000000000,0.659412000000000,0.658457000000000,0.662085000000000,0.661962000000000,0.661010000000000,0.659893000000000,0.826803000000000,0.843421000000000,1.25881000000000,1.27260000000000,2.92241000000000,2.91160000000000,3.42151000000000,3.42102000000000,4.53289000000000,4.60868000000000,4.96114000000000,5.56952000000000,5.65114000000000,4.38028000000000,4.26312000000000,4.25821000000000,4.25729000000000,0.212545000000000,0.143331000000000;0.862698000000000,0.885680000000000,0.866270000000000,0.733746000000000,0.662606000000000,0.660452000000000,0.664285000000000,0.664027000000000,0.651322000000000,0.650347000000000,0.825681000000000,0.839768000000000,1.27091000000000,1.28480000000000,2.96842000000000,2.95877000000000,3.47279000000000,3.47257000000000,4.98717000000000,4.94002000000000,4.56707000000000,4.40366000000000,4.38028000000000,5.65114000000000,5.12216000000000,5.10067000000000,5.09085000000000,0.209396000000000,0.133408000000000;0.859030000000000,0.886935000000000,0.870626000000000,0.728531000000000,0.665187000000000,0.663937000000000,0.666487000000000,0.666291000000000,0.650901000000000,0.650861000000000,0.832854000000000,0.847626000000000,1.27007000000000,1.28363000000000,2.94891000000000,2.94308000000000,3.44624000000000,3.44610000000000,4.71398000000000,4.68074000000000,4.41844000000000,4.27623000000000,4.26312000000000,5.12216000000000,5.65114000000000,5.59957000000000,5.60595000000000,0.208506000000000,0.129537000000000;0.859959000000000,0.885868000000000,0.871644000000000,0.728908000000000,0.664721000000000,0.663950000000000,0.666699000000000,0.666536000000000,0.651734000000000,0.650878000000000,0.834528000000000,0.848407000000000,1.27084000000000,1.28360000000000,2.94805000000000,2.94220000000000,3.44685000000000,3.44666000000000,4.70009000000000,4.66746000000000,4.42186000000000,4.27209000000000,4.25821000000000,5.10067000000000,5.59957000000000,5.65114000000000,5.58139000000000,0.208054000000000,0.129401000000000;0.858669000000000,0.886559000000000,0.872014000000000,0.729206000000000,0.665141000000000,0.663977000000000,0.666718000000000,0.666086000000000,0.650906000000000,0.651159000000000,0.834024000000000,0.847475000000000,1.26911000000000,1.28307000000000,2.94834000000000,2.94135000000000,3.44943000000000,3.44955000000000,4.69984000000000,4.66485000000000,4.40812000000000,4.27398000000000,4.25729000000000,5.09085000000000,5.60595000000000,5.58139000000000,5.65114000000000,0.208186000000000,0.128805000000000;0.301482000000000,0.270460000000000,0.348713000000000,0.356203000000000,0.384514000000000,0.385238000000000,0.384234000000000,0.383484000000000,0.373907000000000,0.371817000000000,0.366917000000000,0.364035000000000,0.355439000000000,0.355189000000000,0.200745000000000,0.201101000000000,0.203568000000000,0.203541000000000,0.212312000000000,0.213141000000000,0.212132000000000,0.211755000000000,0.212545000000000,0.209396000000000,0.208506000000000,0.208054000000000,0.208186000000000,5.65114000000000,2.30695000000000;0.217734000000000,0.239052000000000,0.270181000000000,0.253949000000000,0.282762000000000,0.282704000000000,0.285356000000000,0.285423000000000,0.289707000000000,0.288373000000000,0.276739000000000,0.271545000000000,0.244943000000000,0.244617000000000,0.131868000000000,0.132724000000000,0.143518000000000,0.143581000000000,0.138424000000000,0.138228000000000,0.140000000000000,0.143208000000000,0.143331000000000,0.133408000000000,0.129537000000000,0.129401000000000,0.128805000000000,2.30695000000000,5.65114000000000];
heatmap(MI_voltAng,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_voltages];
ax.YData =[target_phase_names_voltages];
title ('VoltageAng')


figure
MI_voltAng_currAng = [0.0292653000000000,0.0293375000000000,0.0301710000000000,0.0320301000000000,0.0447667000000000,0.0490711000000000,0.0491088000000000,0.763613000000000,0.764775000000000,1.00573000000000,0,7.71620000000000e-05,0.000153416000000000,0,0,0,0.0177851000000000,0.0119889000000000,0.00615603000000000,0,0,0.0141180000000000,0.0137441000000000,0.0499119000000000,0,0,0.761329000000000,0.0402454000000000,0.0402300000000000;0.0263330000000000,0.0264303000000000,0.0265031000000000,0.0244719000000000,0.0303355000000000,0.0308412000000000,0.0308475000000000,0.787854000000000,0.787866000000000,1.03241000000000,0.0359050000000000,0.0369496000000000,0.0380106000000000,0.0195299000000000,0.0192247000000000,0.00528115000000000,0.0310384000000000,0.00689709000000000,0.0149527000000000,0,0,0.00845472000000000,0.00861852000000000,0.0331842000000000,0,0,0.786272000000000,0.0426119000000000,0.0425924000000000;0.0622934000000000,0.0630254000000000,0.0622135000000000,0.0617176000000000,0.0674068000000000,0.0658306000000000,0.0658147000000000,0.834254000000000,0.842689000000000,1.14724000000000,0.0598692000000000,0.0594665000000000,0.0593939000000000,0.0196988000000000,0.0203628000000000,0.0171295000000000,0,0.0335806000000000,0.0333252000000000,0,0,0.0168636000000000,0.0161185000000000,0.0663139000000000,0,0,0.782288000000000,0.0690616000000000,0.0690969000000000;0.0436022000000000,0.0443091000000000,0.0441900000000000,0.0454120000000000,0.0476318000000000,0.0513185000000000,0.0513359000000000,0.882659000000000,0.885020000000000,1.22971000000000,0.000284169000000000,0,0,0,0,0,0,0.00710587000000000,0.00405045000000000,0.0221166000000000,0.0219980000000000,0,0,0.0621373000000000,0,0,0.673701000000000,0.0965224000000000,0.0965225000000000;0.0733977000000000,0.0736145000000000,0.0726768000000000,0.0684970000000000,0.0642888000000000,0.0621248000000000,0.0621435000000000,0.913064000000000,0.919399000000000,1.30037000000000,0.0191444000000000,0.0189209000000000,0.0192764000000000,0,0,0,0,0.000688167000000000,0,0.000995169000000000,0.00102350000000000,0,0,0.0704877000000000,0,0,0.604150000000000,0.108822000000000,0.108783000000000;0.0738951000000000,0.0737753000000000,0.0736533000000000,0.0683681000000000,0.0647038000000000,0.0616215000000000,0.0616585000000000,0.911834000000000,0.917298000000000,1.30302000000000,0.0197990000000000,0.0185176000000000,0.0187332000000000,0,0,0,0,0.00185518000000000,0,0.000122285000000000,7.48942000000000e-05,0,0,0.0709390000000000,0,0,0.602826000000000,0.109361000000000,0.109343000000000;0.0731347000000000,0.0724439000000000,0.0720290000000000,0.0678032000000000,0.0631595000000000,0.0608980000000000,0.0609207000000000,0.911279000000000,0.919753000000000,1.29630000000000,0.0185374000000000,0.0185177000000000,0.0185508000000000,0,0,0,0,0.00141885000000000,0,0.000408218000000000,0.000340789000000000,0,0,0.0703143000000000,0,0,0.607897000000000,0.108400000000000,0.108361000000000;0.0730988000000000,0.0723705000000000,0.0720438000000000,0.0677088000000000,0.0627187000000000,0.0607459000000000,0.0607363000000000,0.910917000000000,0.919484000000000,1.29611000000000,0.0184570000000000,0.0183054000000000,0.0185542000000000,0,0,0,0,0.00162305000000000,0,0,0,0,0,0.0695604000000000,0,0,0.607731000000000,0.108951000000000,0.108917000000000;0.0743245000000000,0.0733016000000000,0.0729704000000000,0.0629333000000000,0.0604510000000000,0.0587510000000000,0.0587737000000000,0.927301000000000,0.934245000000000,1.32352000000000,0.00371030000000000,0.00460637000000000,0.00546131000000000,0,0,0,0,0,0,0,0,0,0,0.0737643000000000,0,0,0.607920000000000,0.105602000000000,0.105600000000000;0.0734512000000000,0.0726016000000000,0.0720855000000000,0.0620902000000000,0.0604631000000000,0.0593242000000000,0.0593790000000000,0.928509000000000,0.936061000000000,1.32672000000000,0.00366836000000000,0.00322965000000000,0.00370488000000000,0,0,0,0,0,0,0,0,0,0,0.0749750000000000,0,0,0.608756000000000,0.103953000000000,0.103950000000000;0.0438894000000000,0.0441674000000000,0.0437829000000000,0.0376362000000000,0.0376313000000000,0.0409874000000000,0.0410101000000000,0.850134000000000,0.853689000000000,1.12998000000000,0.00549078000000000,0.00792480000000000,0.00780609000000000,0,0,0,0.00647468000000000,0.0121965000000000,0.0266911000000000,0,0,0.0175280000000000,0.0174241000000000,0.0800331000000000,0,0,0.757817000000000,0.0451644000000000,0.0451874000000000;0.0376067000000000,0.0371239000000000,0.0378155000000000,0.0342464000000000,0.0322314000000000,0.0373681000000000,0.0373908000000000,0.842520000000000,0.848612000000000,1.13221000000000,0.00597716000000000,0.00694500000000000,0.00711931000000000,0,0,0,0.0109266000000000,0.0192454000000000,0.0278021000000000,0,0,0.0184411000000000,0.0186355000000000,0.0813633000000000,0,0,0.759901000000000,0.0352190000000000,0.0352547000000000;0.00793436000000000,0.00808034000000000,0.00807910000000000,0.00588906000000000,0,0.00406349000000000,0.00406520000000000,0.657684000000000,0.658527000000000,0.918373000000000,0.0191960000000000,0.0203849000000000,0.0199789000000000,0,0,0,0.0175943000000000,0,0.0150461000000000,0,0,0.0244189000000000,0.0250101000000000,0.0773015000000000,0,0,1.03276000000000,0.0444000000000000,0.0444371000000000;0.00717068000000000,0.00667911000000000,0.00620874000000000,0.00412755000000000,0,0.00569588000000000,0.00573376000000000,0.651298000000000,0.653058000000000,0.906533000000000,0.0180640000000000,0.0195982000000000,0.0199463000000000,0,0,0,0.0173278000000000,0,0.0155194000000000,0,0,0.0232449000000000,0.0245349000000000,0.0801125000000000,0,0,1.04118000000000,0.0401765000000000,0.0402522000000000;0.0191836000000000,0.0179800000000000,0.0176180000000000,0.0132993000000000,0.00206907000000000,0.00526770000000000,0.00523993000000000,0.429908000000000,0.430282000000000,0.549993000000000,0.0325775000000000,0.0361119000000000,0.0366162000000000,0.00457304000000000,0.00430520000000000,0.0115460000000000,0.0879061000000000,0.0116508000000000,0.0849221000000000,0.0252812000000000,0.0252709000000000,0.0336431000000000,0.0343138000000000,0.137630000000000,0.0556713000000000,0,1.42124000000000,0.00574960000000000,0.00575990000000000;0.0196977000000000,0.0186430000000000,0.0182897000000000,0.0132356000000000,0.00206296000000000,0.00452443000000000,0.00449665000000000,0.429272000000000,0.429425000000000,0.552179000000000,0.0311125000000000,0.0356063000000000,0.0363934000000000,0.00455066000000000,0.00428991000000000,0.0115998000000000,0.0868930000000000,0.0125209000000000,0.0841908000000000,0.0248376000000000,0.0247351000000000,0.0344313000000000,0.0352667000000000,0.137555000000000,0.0558808000000000,0,1.41926000000000,0.00506379000000000,0.00508760000000000;0.00958295000000000,0.00836515000000000,0.00774989000000000,0.000701239000000000,0,0,0,0.386589000000000,0.388345000000000,0.510547000000000,0.0370146000000000,0.0424492000000000,0.0435442000000000,0.0209355000000000,0.0207101000000000,0.0273678000000000,0.105917000000000,0,0.104593000000000,0.0225691000000000,0.0225855000000000,0.0279695000000000,0.0274675000000000,0.138159000000000,0.0485963000000000,0,1.44578000000000,0.0394634000000000,0.0394520000000000;0.00959723000000000,0.00836371000000000,0.00773723000000000,0.000696022000000000,0,0,0,0.386493000000000,0.388313000000000,0.510586000000000,0.0370402000000000,0.0424456000000000,0.0435054000000000,0.0208502000000000,0.0206765000000000,0.0273732000000000,0.105884000000000,0,0.104627000000000,0.0224922000000000,0.0224960000000000,0.0278591000000000,0.0274109000000000,0.138159000000000,0.0486822000000000,0,1.44577000000000,0.0393826000000000,0.0394064000000000;0.000394859000000000,0,0.000170064000000000,0,7.89215000000000e-05,0.00335848000000000,0.00335848000000000,0.377677000000000,0.379584000000000,0.471728000000000,0.0406069000000000,0.0442777000000000,0.0446432000000000,0.0331233000000000,0.0332280000000000,0.0310504000000000,0.140258000000000,0.0250132000000000,0.132540000000000,0.0277205000000000,0.0277234000000000,0.0121232000000000,0.0124469000000000,0.136162000000000,0.0326519000000000,0,1.46267000000000,0.0487258000000000,0.0486958000000000;5.23686000000000e-05,0.000492255000000000,0.000498291000000000,0,0.000255316000000000,0.00335139000000000,0.00335139000000000,0.376843000000000,0.378071000000000,0.472552000000000,0.0416100000000000,0.0455060000000000,0.0457264000000000,0.0337520000000000,0.0339420000000000,0.0327854000000000,0.141365000000000,0.0254412000000000,0.133159000000000,0.0284909000000000,0.0284550000000000,0.0117558000000000,0.0117264000000000,0.135761000000000,0.0332107000000000,0,1.46094000000000,0.0481105000000000,0.0481419000000000;2.74322000000000e-05,0,0,0.00151877000000000,0.00351663000000000,0.00510130000000000,0.00513340000000000,0.372130000000000,0.370877000000000,0.471546000000000,0.0452695000000000,0.0483854000000000,0.0481631000000000,0.0312944000000000,0.0315074000000000,0.0376986000000000,0.142310000000000,0.0279190000000000,0.137943000000000,0.0302174000000000,0.0302695000000000,0.00822368000000000,0.00834504000000000,0.132672000000000,0.0375116000000000,0,1.46266000000000,0.0419981000000000,0.0420254000000000;0.00586338000000000,0.00573498000000000,0.00647845000000000,0.00873666000000000,0.00708024000000000,0.00514693000000000,0.00521742000000000,0.364507000000000,0.365735000000000,0.471197000000000,0.0483350000000000,0.0532606000000000,0.0536719000000000,0.0321322000000000,0.0318581000000000,0.0391947000000000,0.146061000000000,0.0242306000000000,0.140559000000000,0.0245277000000000,0.0245110000000000,0.00590758000000000,0.00606814000000000,0.131456000000000,0.0394817000000000,0,1.46239000000000,0.0434293000000000,0.0433721000000000;0.00604660000000000,0.00588398000000000,0.00636957000000000,0.00901848000000000,0.00723124000000000,0.00492187000000000,0.00491226000000000,0.363400000000000,0.364545000000000,0.470612000000000,0.0484059000000000,0.0537001000000000,0.0536584000000000,0.0320148000000000,0.0320833000000000,0.0381546000000000,0.146363000000000,0.0237604000000000,0.141194000000000,0.0238051000000000,0.0237874000000000,0.00562767000000000,0.00581105000000000,0.131953000000000,0.0385419000000000,0,1.46233000000000,0.0432480000000000,0.0432687000000000;0.00411995000000000,0.00395552000000000,0.00472964000000000,0.00643287000000000,0.00330165000000000,0.00576728000000000,0.00573395000000000,0.369985000000000,0.368427000000000,0.468147000000000,0.0385614000000000,0.0422122000000000,0.0422390000000000,0.0355988000000000,0.0355181000000000,0.0323580000000000,0.141215000000000,0.0202821000000000,0.137827000000000,0.0332314000000000,0.0332068000000000,0.0164415000000000,0.0166930000000000,0.136091000000000,0.0298793000000000,0,1.46286000000000,0.0446470000000000,0.0446738000000000;0.00938612000000000,0.00980914000000000,0.0100643000000000,0.0109605000000000,0.00672813000000000,0.00789725000000000,0.00791134000000000,0.365636000000000,0.365194000000000,0.464950000000000,0.0431608000000000,0.0438615000000000,0.0442385000000000,0.0300867000000000,0.0303605000000000,0.0295274000000000,0.143283000000000,0.0167320000000000,0.138896000000000,0.0354100000000000,0.0353969000000000,0.0217791000000000,0.0214587000000000,0.135299000000000,0.0302882000000000,0,1.45729000000000,0.0438170000000000,0.0437861000000000;0.00962932000000000,0.0100672000000000,0.0100655000000000,0.0113722000000000,0.00693333000000000,0.00790983000000000,0.00790983000000000,0.365572000000000,0.364911000000000,0.465442000000000,0.0433976000000000,0.0442490000000000,0.0444770000000000,0.0298360000000000,0.0299307000000000,0.0296181000000000,0.142721000000000,0.0166231000000000,0.139047000000000,0.0350692000000000,0.0350657000000000,0.0225663000000000,0.0219253000000000,0.135005000000000,0.0300649000000000,0,1.45867000000000,0.0435227000000000,0.0434916000000000;0.00950351000000000,0.00986144000000000,0.00987859000000000,0.0110345000000000,0.00701782000000000,0.00810904000000000,0.00811424000000000,0.365929000000000,0.365274000000000,0.466240000000000,0.0439882000000000,0.0444521000000000,0.0446032000000000,0.0295717000000000,0.0296503000000000,0.0292651000000000,0.143579000000000,0.0171630000000000,0.138601000000000,0.0350552000000000,0.0350811000000000,0.0215809000000000,0.0206663000000000,0.134808000000000,0.0307021000000000,0,1.45730000000000,0.0440179000000000,0.0439700000000000;0.0877032000000000,0.0888258000000000,0.0888942000000000,0.0866670000000000,0.0781460000000000,0.0748508000000000,0.0748202000000000,0.140110000000000,0.143101000000000,0.211676000000000,0.0392228000000000,0.0375242000000000,0.0371864000000000,0.0452983000000000,0.0449486000000000,0.0379312000000000,0,0.0145547000000000,0,0.0286264000000000,0.0286343000000000,0.0298448000000000,0.0289751000000000,0.0388256000000000,0.0496851000000000,0,0.276461000000000,0.813354000000000,0.813317000000000;0.0637972000000000,0.0631117000000000,0.0632336000000000,0.0610984000000000,0.0709697000000000,0.0670183000000000,0.0670699000000000,0.0672703000000000,0.0719675000000000,0.187155000000000,0.0689704000000000,0.0676924000000000,0.0677078000000000,0.106595000000000,0.106456000000000,0.110686000000000,0.00884727000000000,0,0.0154145000000000,0.0159173000000000,0.0158888000000000,0.0104963000000000,0.0123954000000000,0,0.0548933000000000,0,0.199625000000000,1.05537000000000,1.05537000000000];
heatmap(MI_voltAng_currAng,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_currents];
ax.YData =[target_phase_names_voltages];
title ('VoltageAng-CurrentAng')


figure
MI_voltMag_currMag = [2.43978000000000,2.43825000000000,2.43786000000000,2.43373000000000,2.42940000000000,2.30852000000000,2.30852000000000,0.234536000000000,0.234489000000000,0.194976000000000,0.672179000000000,0.673189000000000,0.672980000000000,0.659683000000000,0.659482000000000,0.623133000000000,0.276407000000000,0,0.281734000000000,0.230808000000000,0.231114000000000,0.0183349000000000,0.0197187000000000,0.0514638000000000,0.0170266000000000,0.0255574000000000,0.133977000000000,0.191412000000000,0.191412000000000;2.44502000000000,2.44306000000000,2.44339000000000,2.43837000000000,2.43265000000000,2.31452000000000,2.31447000000000,0.235648000000000,0.235607000000000,0.205077000000000,0.680595000000000,0.682120000000000,0.682415000000000,0.663393000000000,0.663613000000000,0.628780000000000,0.272948000000000,0,0.282887000000000,0.228149000000000,0.227790000000000,0.00999445000000000,0.00974403000000000,0.0558495000000000,0.0105261000000000,0.0229756000000000,0.138336000000000,0.196333000000000,0.196333000000000;2.48876000000000,2.48821000000000,2.48831000000000,2.49075000000000,2.48655000000000,2.35868000000000,2.35875000000000,0.247030000000000,0.247063000000000,0.204752000000000,0.690519000000000,0.690206000000000,0.690196000000000,0.670595000000000,0.670671000000000,0.643700000000000,0.285351000000000,0.0251911000000000,0.290370000000000,0.241955000000000,0.241701000000000,0,0,0.0595061000000000,0.0200613000000000,0.0260520000000000,0.147002000000000,0.196644000000000,0.196644000000000;2.49512000000000,2.49490000000000,2.49522000000000,2.49041000000000,2.49064000000000,2.36074000000000,2.36074000000000,0.245045000000000,0.245069000000000,0.201542000000000,0.686327000000000,0.686836000000000,0.686714000000000,0.674133000000000,0.673843000000000,0.646851000000000,0.287369000000000,0.0246938000000000,0.289769000000000,0.241933000000000,0.242671000000000,0,0,0.0610548000000000,0.0216215000000000,0.0276193000000000,0.146228000000000,0.205883000000000,0.205883000000000;2.49346000000000,2.49256000000000,2.49254000000000,2.48812000000000,2.49062000000000,2.36574000000000,2.36574000000000,0.245092000000000,0.245061000000000,0.200657000000000,0.683775000000000,0.682966000000000,0.683005000000000,0.674033000000000,0.673782000000000,0.647765000000000,0.287997000000000,0.0256257000000000,0.292581000000000,0.243372000000000,0.243601000000000,0,0,0.0608266000000000,0.0216563000000000,0.0301513000000000,0.147155000000000,0.208924000000000,0.208924000000000;0.889798000000000,0.888556000000000,0.888816000000000,0.887528000000000,0.882040000000000,0.764829000000000,0.764839000000000,0.0490065000000000,0.0490015000000000,0.0238433000000000,0.227282000000000,0.227321000000000,0.227477000000000,0.222412000000000,0.222427000000000,0.180341000000000,0.109863000000000,0.0320162000000000,0.103534000000000,0.0978295000000000,0.0974990000000000,0.00228109000000000,0.00129649000000000,0.0141596000000000,0,0,0.107598000000000,0.0764051000000000,0.0764051000000000;0.877924000000000,0.876985000000000,0.876779000000000,0.873500000000000,0.869183000000000,0.752185000000000,0.752118000000000,0.0449584000000000,0.0449701000000000,0.0232221000000000,0.226867000000000,0.226168000000000,0.226109000000000,0.210846000000000,0.211004000000000,0.174839000000000,0.115141000000000,0.0220923000000000,0.0985691000000000,0.100265000000000,0.100331000000000,0,0,0.00830016000000000,0,0,0.113380000000000,0.0728890000000000,0.0728890000000000;0.776728000000000,0.776487000000000,0.776837000000000,0.777953000000000,0.778497000000000,0.673162000000000,0.673162000000000,0.0389913000000000,0.0389869000000000,0.0105522000000000,0.269755000000000,0.270619000000000,0.270862000000000,0.264311000000000,0.264389000000000,0.236561000000000,0.0586024000000000,0,0.0974138000000000,0.0795219000000000,0.0795964000000000,0,0,0,0,0.0154161000000000,0.164579000000000,0.0536125000000000,0.0536125000000000;0.226027000000000,0.226520000000000,0.226602000000000,0.226039000000000,0.222014000000000,0.219176000000000,0.219176000000000,0.719445000000000,0.719511000000000,0.753485000000000,0.0742349000000000,0.0743833000000000,0.0747594000000000,0.0840758000000000,0.0841286000000000,0.0686318000000000,0.0121545000000000,0.00859210000000000,0.0355592000000000,0.0201918000000000,0.0202333000000000,0,0.000386100000000000,0.00794362000000000,0,0.0211024000000000,0.0521512000000000,0,0;0.205150000000000,0.205069000000000,0.205478000000000,0.205942000000000,0.206692000000000,0.222071000000000,0.222053000000000,0.803356000000000,0.803325000000000,0.854999000000000,0.0715458000000000,0.0726570000000000,0.0730689000000000,0.0699494000000000,0.0698429000000000,0.0671650000000000,0.0133706000000000,0.00454795000000000,0.0306125000000000,0,0,0,0,0,0.00362289000000000,0.0273987000000000,0.0368485000000000,0.00936890000000000,0.00936890000000000;1.01579000000000,1.01590000000000,1.01580000000000,1.02193000000000,1.02912000000000,0.921287000000000,0.921287000000000,0.147534000000000,0.147416000000000,0.102144000000000,0.192774000000000,0.194387000000000,0.194578000000000,0.176615000000000,0.176622000000000,0.124102000000000,0.0490547000000000,0,0.0749627000000000,0.0284825000000000,0.0295266000000000,0,0,0,0,0.0226174000000000,0.148461000000000,0.0372323000000000,0.0372323000000000;1.03446000000000,1.03450000000000,1.03513000000000,1.04062000000000,1.04901000000000,0.945933000000000,0.945933000000000,0.143874000000000,0.143840000000000,0.0976474000000000,0.211412000000000,0.212689000000000,0.212707000000000,0.193652000000000,0.193787000000000,0.137819000000000,0.0509999000000000,0,0.0706715000000000,0.0459700000000000,0.0462203000000000,0,0,0,0,0.0277741000000000,0.146059000000000,0.0520323000000000,0.0520323000000000;1.18275000000000,1.18434000000000,1.18590000000000,1.20086000000000,1.21687000000000,1.12694000000000,1.12694000000000,0.112705000000000,0.112520000000000,0.0901421000000000,0.654512000000000,0.655005000000000,0.655081000000000,0.668028000000000,0.668118000000000,0.611201000000000,0.185483000000000,0,0.219355000000000,0.191207000000000,0.191024000000000,0.0147271000000000,0.0146835000000000,0.0252199000000000,0,0.0108005000000000,0.0609582000000000,0.191617000000000,0.191617000000000;1.18203000000000,1.18332000000000,1.18441000000000,1.19909000000000,1.21708000000000,1.12366000000000,1.12366000000000,0.114447000000000,0.114470000000000,0.0841398000000000,0.668980000000000,0.669667000000000,0.669971000000000,0.681433000000000,0.681627000000000,0.625573000000000,0.189943000000000,0,0.226598000000000,0.187769000000000,0.188477000000000,0.0119903000000000,0.0116425000000000,0.0263672000000000,0,0.0145684000000000,0.0664645000000000,0.203190000000000,0.203190000000000;0.958857000000000,0.959799000000000,0.960443000000000,0.970392000000000,0.978791000000000,0.892852000000000,0.892852000000000,0.0601986000000000,0.0602140000000000,0.0536037000000000,1.27240000000000,1.26959000000000,1.26971000000000,1.27199000000000,1.27195000000000,1.22885000000000,0.372407000000000,0.0242550000000000,0.380813000000000,0.272883000000000,0.273175000000000,0,0,0.000906398000000000,0,0.0262441000000000,0.476257000000000,0.274084000000000,0.274084000000000;0.146950000000000,0.146842000000000,0.146698000000000,0.145596000000000,0.146753000000000,0.142947000000000,0.142947000000000,0.0516711000000000,0.0516834000000000,0.0405208000000000,0.274485000000000,0.275523000000000,0.275534000000000,0.290322000000000,0.290666000000000,0.246634000000000,0.0473093000000000,0,0.0311090000000000,0.117654000000000,0.116199000000000,0,0,0,0.0339612000000000,0.0497899000000000,0.907704000000000,0.0332063000000000,0.0332063000000000;0.140535000000000,0.140571000000000,0.140804000000000,0.139785000000000,0.138025000000000,0.111425000000000,0.111425000000000,0,0,0.0257541000000000,0.186700000000000,0.184930000000000,0.185360000000000,0.208857000000000,0.208730000000000,0.161923000000000,0.00856599000000000,0.000620462000000000,0.0102735000000000,0.0140300000000000,0.0138511000000000,0.000823585000000000,0.00129142000000000,0,0.0173478000000000,0.0363505000000000,1.02333000000000,0.0607474000000000,0.0607777000000000;0.140585000000000,0.140739000000000,0.140943000000000,0.139437000000000,0.138686000000000,0.111194000000000,0.111194000000000,0,0,0.0256268000000000,0.186332000000000,0.185423000000000,0.185698000000000,0.208893000000000,0.208931000000000,0.162048000000000,0.00873952000000000,0.000296913000000000,0.0101959000000000,0.0143696000000000,0.0144960000000000,0.00125247000000000,0.000875452000000000,0,0.0182440000000000,0.0363288000000000,1.02280000000000,0.0600849000000000,0.0600849000000000;0.0923485000000000,0.0923907000000000,0.0923680000000000,0.0903852000000000,0.0912960000000000,0.0798967000000000,0.0798830000000000,0.0404087000000000,0.0404184000000000,0.0388187000000000,0.128498000000000,0.128224000000000,0.128429000000000,0.131389000000000,0.131495000000000,0.104400000000000,0.0220288000000000,0.00860194000000000,0.0221036000000000,0.0373778000000000,0.0370705000000000,0.0259372000000000,0.0263551000000000,0.0461108000000000,0,0.00946417000000000,1.05389000000000,0.0458664000000000,0.0458664000000000;0.0824798000000000,0.0825213000000000,0.0824786000000000,0.0812944000000000,0.0815073000000000,0.0745598000000000,0.0745598000000000,0.0515593000000000,0.0514842000000000,0.0358068000000000,0.127878000000000,0.128603000000000,0.128672000000000,0.131411000000000,0.131274000000000,0.102841000000000,0.0256330000000000,0.00343122000000000,0.0206866000000000,0.0380201000000000,0.0372104000000000,0.0224131000000000,0.0230070000000000,0.0427083000000000,0,0.00520099000000000,1.04322000000000,0.0400502000000000,0.0400502000000000;0.0589482000000000,0.0589470000000000,0.0584938000000000,0.0570552000000000,0.0600012000000000,0.0440676000000000,0.0440676000000000,0.0560861000000000,0.0560522000000000,0.0466490000000000,0.121577000000000,0.123448000000000,0.123769000000000,0.123912000000000,0.123783000000000,0.0882322000000000,0.0364605000000000,0,0.0316318000000000,0.0384692000000000,0.0382282000000000,0,0,0.0382958000000000,0,0.0199599000000000,1.03150000000000,0.0266042000000000,0.0266042000000000;0.0694477000000000,0.0695453000000000,0.0694460000000000,0.0690296000000000,0.0689357000000000,0.0525515000000000,0.0525515000000000,0.0634984000000000,0.0634115000000000,0.0450739000000000,0.134321000000000,0.135094000000000,0.135087000000000,0.121372000000000,0.121330000000000,0.0847800000000000,0.0378408000000000,0.00109311000000000,0.0315498000000000,0.0429050000000000,0.0421941000000000,0,0,0.0312942000000000,0,0.0241279000000000,1.01666000000000,0.0390637000000000,0.0390637000000000;0.0708627000000000,0.0707771000000000,0.0707179000000000,0.0709261000000000,0.0701780000000000,0.0539706000000000,0.0539910000000000,0.0616856000000000,0.0616694000000000,0.0432961000000000,0.133551000000000,0.135233000000000,0.135724000000000,0.119965000000000,0.120200000000000,0.0860067000000000,0.0382370000000000,0.00193388000000000,0.0302320000000000,0.0456317000000000,0.0450072000000000,0,0,0.0329470000000000,0,0.0241875000000000,1.01973000000000,0.0413567000000000,0.0412960000000000;0.0871870000000000,0.0869878000000000,0.0867374000000000,0.0833383000000000,0.0819107000000000,0.0670298000000000,0.0670389000000000,0.0414818000000000,0.0413536000000000,0.0358809000000000,0.116762000000000,0.117148000000000,0.117021000000000,0.108083000000000,0.107956000000000,0.0769836000000000,0.0198295000000000,0.00510857000000000,0.0249755000000000,0.0434299000000000,0.0427900000000000,0.0279706000000000,0.0276602000000000,0.0487692000000000,0,0.00662431000000000,1.07194000000000,0.0539463000000000,0.0539463000000000;0.0735365000000000,0.0736002000000000,0.0733260000000000,0.0713557000000000,0.0702756000000000,0.0620868000000000,0.0620868000000000,0.0360775000000000,0.0359887000000000,0.0356499000000000,0.114909000000000,0.115628000000000,0.115812000000000,0.107214000000000,0.107153000000000,0.0712441000000000,0.0205636000000000,0,0.0261331000000000,0.0461890000000000,0.0460176000000000,0.0302019000000000,0.0305128000000000,0.0456915000000000,0,0.00702191000000000,1.07997000000000,0.0590519000000000,0.0590519000000000;0.0727672000000000,0.0725519000000000,0.0724644000000000,0.0701941000000000,0.0694965000000000,0.0627595000000000,0.0627595000000000,0.0352504000000000,0.0351918000000000,0.0344652000000000,0.114751000000000,0.115006000000000,0.115188000000000,0.105188000000000,0.105398000000000,0.0684814000000000,0.0221238000000000,0,0.0264200000000000,0.0478345000000000,0.0475963000000000,0.0287188000000000,0.0295795000000000,0.0470541000000000,0,0.00766185000000000,1.08277000000000,0.0614785000000000,0.0614785000000000;0.0733776000000000,0.0734485000000000,0.0731002000000000,0.0712920000000000,0.0700344000000000,0.0619647000000000,0.0619647000000000,0.0359017000000000,0.0358888000000000,0.0355610000000000,0.115055000000000,0.115437000000000,0.115590000000000,0.106628000000000,0.106799000000000,0.0712580000000000,0.0204261000000000,0,0.0260216000000000,0.0461888000000000,0.0460207000000000,0.0302055000000000,0.0308194000000000,0.0456559000000000,0,0.00680479000000000,1.08045000000000,0.0589403000000000,0.0589403000000000;0.213504000000000,0.213267000000000,0.213467000000000,0.214093000000000,0.214170000000000,0.213381000000000,0.213381000000000,0.0349648000000000,0.0351349000000000,0.0299292000000000,0.223672000000000,0.222438000000000,0.222038000000000,0.220426000000000,0.220642000000000,0.225302000000000,0.00820660000000000,0,0,0,0,0.0425866000000000,0.0412868000000000,0.0288887000000000,0.0117209000000000,0,0.0827376000000000,1.05507000000000,1.05507000000000;0.245776000000000,0.245473000000000,0.245281000000000,0.244048000000000,0.244325000000000,0.231064000000000,0.231064000000000,0,0,0,0.286226000000000,0.286063000000000,0.286388000000000,0.307609000000000,0.307472000000000,0.313597000000000,0.0273118000000000,0,0.0186840000000000,0.0107037000000000,0.0106820000000000,0,0,0,0.0105180000000000,0,0.0857741000000000,2.24714000000000,2.24714000000000];
heatmap(MI_voltMag_currMag,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_currents];
ax.YData =[target_phase_names_voltages];
title ('VoltageMag-CurrentMag')


figure
MI_voltAng_currMag = [0.153829000000000,0.153705000000000,0.153602000000000,0.152112000000000,0.153103000000000,0.136973000000000,0.136973000000000,0.561621000000000,0.561607000000000,0.517235000000000,0.0216351000000000,0.0218879000000000,0.0222185000000000,0.0508013000000000,0.0508811000000000,0.0388929000000000,0,0,0,0,0,0.0341658000000000,0.0337862000000000,0,0.0109030000000000,0.0333881000000000,0,0,0;0.131692000000000,0.131673000000000,0.131239000000000,0.129725000000000,0.129820000000000,0.123363000000000,0.123347000000000,0.572281000000000,0.572287000000000,0.534430000000000,0.00626123000000000,0.00662166000000000,0.00698854000000000,0.0278918000000000,0.0278647000000000,0.0266577000000000,0.00231156000000000,0,0.00616625000000000,0,0,0.0215438000000000,0.0222295000000000,0,0.00289845000000000,0.00698366000000000,0,0,0;0.145219000000000,0.145194000000000,0.144858000000000,0.145936000000000,0.145444000000000,0.128826000000000,0.128826000000000,0.628660000000000,0.628670000000000,0.587656000000000,0,0,0,0.0107935000000000,0.0109745000000000,0.0103557000000000,0,0.0131581000000000,0.00369729000000000,0,0,0,0,0,0,0.00217655000000000,0.0207994000000000,0.0435607000000000,0.0435607000000000;0.201147000000000,0.200961000000000,0.200684000000000,0.200675000000000,0.199896000000000,0.179053000000000,0.179036000000000,0.639270000000000,0.639124000000000,0.598246000000000,0.0249229000000000,0.0235018000000000,0.0237635000000000,0,0,0.00420574000000000,0,0,0,0.00838965000000000,0.00867435000000000,0.00404335000000000,0.00308867000000000,0,0,0,0.0283871000000000,0.0487145000000000,0.0487145000000000;0.230034000000000,0.230109000000000,0.229962000000000,0.230516000000000,0.232038000000000,0.209921000000000,0.209899000000000,0.661035000000000,0.660960000000000,0.645331000000000,0.0183077000000000,0.0170684000000000,0.0170707000000000,0,0,5.34270000000000e-05,0,0,0,0,0,0,0,0.00560333000000000,0,0,0.0109816000000000,0.0402844000000000,0.0402844000000000;0.230601000000000,0.230590000000000,0.230447000000000,0.231150000000000,0.232307000000000,0.210153000000000,0.210153000000000,0.665963000000000,0.665944000000000,0.647433000000000,0.0170837000000000,0.0171454000000000,0.0171566000000000,0,0,0.000212674000000000,0,0,0,0,0,0,0,0.00772211000000000,0,0,0.0125856000000000,0.0404624000000000,0.0404624000000000;0.228453000000000,0.228629000000000,0.228455000000000,0.228575000000000,0.230514000000000,0.209883000000000,0.209909000000000,0.657410000000000,0.657356000000000,0.642044000000000,0.0178902000000000,0.0167203000000000,0.0163912000000000,0,0,0,0,0,0,0,0,0,0,0.00476576000000000,0,0,0.0131302000000000,0.0397313000000000,0.0397313000000000;0.228387000000000,0.228411000000000,0.228294000000000,0.228467000000000,0.230069000000000,0.209701000000000,0.209701000000000,0.657655000000000,0.657606000000000,0.642604000000000,0.0171057000000000,0.0164721000000000,0.0163146000000000,0,0,0,0,0,0,0,0,0,0,0.00414976000000000,0,0,0.0127391000000000,0.0398337000000000,0.0398337000000000;0.230448000000000,0.230285000000000,0.230214000000000,0.230846000000000,0.230344000000000,0.204157000000000,0.204157000000000,0.670566000000000,0.670578000000000,0.644818000000000,0.0139896000000000,0.0139804000000000,0.0136464000000000,0,0,0,0,0,0,0,0,0,0,0.00305204000000000,0,0,0.00223998000000000,0.0393498000000000,0.0393498000000000;0.233044000000000,0.233333000000000,0.233261000000000,0.233537000000000,0.233271000000000,0.206730000000000,0.206711000000000,0.673007000000000,0.672881000000000,0.646943000000000,0.0150008000000000,0.0148489000000000,0.0144877000000000,0,0,0,0,0,0,0,0,0,0,0.00276965000000000,0,0,0.00185384000000000,0.0395214000000000,0.0395214000000000;0.173280000000000,0.173242000000000,0.173152000000000,0.173752000000000,0.174404000000000,0.163190000000000,0.163190000000000,0.609368000000000,0.609306000000000,0.595244000000000,0.0209858000000000,0.0188389000000000,0.0187178000000000,0.00494532000000000,0.00509449000000000,0.00784321000000000,0,0,0,0.00709164000000000,0.00710234000000000,0.0258953000000000,0.0238160000000000,0,0,0,0.0600630000000000,0.0395096000000000,0.0395096000000000;0.169238000000000,0.169319000000000,0.169157000000000,0.169306000000000,0.168029000000000,0.160702000000000,0.160721000000000,0.608531000000000,0.608497000000000,0.583025000000000,0.0212417000000000,0.0201777000000000,0.0202305000000000,0.00891844000000000,0.00902941000000000,0.00711238000000000,0,0,0,0,0,0.0245779000000000,0.0236940000000000,0,0,0,0.0577703000000000,0.0303673000000000,0.0303673000000000;0.116438000000000,0.116701000000000,0.116867000000000,0.118542000000000,0.118079000000000,0.108968000000000,0.108986000000000,0.500518000000000,0.500589000000000,0.457123000000000,0.00499748000000000,0.00519157000000000,0.00522289000000000,0.0211096000000000,0.0211894000000000,0.00552658000000000,0.0109500000000000,0,0.0327293000000000,0,0,0.0428573000000000,0.0417578000000000,0.0364322000000000,0.00462139000000000,0,0.0616504000000000,0.0288652000000000,0.0288652000000000;0.116508000000000,0.116578000000000,0.116799000000000,0.118334000000000,0.117281000000000,0.107487000000000,0.107488000000000,0.498476000000000,0.498499000000000,0.452839000000000,0.00325803000000000,0.00300507000000000,0.00296552000000000,0.0158368000000000,0.0158351000000000,0.00250654000000000,0.0137621000000000,0,0.0377500000000000,0,0,0.0437124000000000,0.0429587000000000,0.0329384000000000,0,0,0.0576100000000000,0.0292803000000000,0.0292803000000000;0,0,0,0,0,0,0,0.335102000000000,0.335090000000000,0.298189000000000,0.00119616000000000,0.00181642000000000,0.00226664000000000,0,0,0,0.00945645000000000,0.0170493000000000,0.0257762000000000,0.0374562000000000,0.0373539000000000,0,0,0.0615136000000000,0,0,0.0226305000000000,0,0;0,0,0,0,0,0,0,0.334313000000000,0.334415000000000,0.298172000000000,0.000730327000000000,0.00108601000000000,0.00166400000000000,0,0,0,0.00843898000000000,0.0172170000000000,0.0250945000000000,0.0386834000000000,0.0382186000000000,0,0,0.0617276000000000,0,0,0.0220007000000000,0,0;0,0,0,0,0,0,0,0.316684000000000,0.316730000000000,0.280531000000000,0,0.000711748000000000,0.000912390000000000,0,0,0.00560914000000000,0.0329676000000000,0.00423743000000000,0.0443619000000000,0.0444131000000000,0.0440917000000000,0,0,0.0845201000000000,0,0,0.00861680000000000,0,0;0,0,0,0,0,0,0,0.316752000000000,0.316719000000000,0.280607000000000,0,0.000721376000000000,0.000977961000000000,0,0,0.00553567000000000,0.0330674000000000,0.00422082000000000,0.0444051000000000,0.0442652000000000,0.0440276000000000,0,0,0.0846217000000000,0,0,0.00859484000000000,0,0;0,0,0,0,0,0,0,0.333579000000000,0.333529000000000,0.251202000000000,0,0,0,0,0,0,0.0417415000000000,0.0288929000000000,0.0524791000000000,0.0564845000000000,0.0557852000000000,0.0189541000000000,0.0191155000000000,0.100750000000000,0,0,0,0,0;0,0,0,0,0,0,0,0.334520000000000,0.334564000000000,0.250005000000000,0,0,0,0,0,0,0.0421856000000000,0.0308258000000000,0.0522154000000000,0.0578976000000000,0.0573624000000000,0.0200422000000000,0.0203793000000000,0.100344000000000,0,0,0,0,0;0,0,0,0,0,0.00520084000000000,0.00520084000000000,0.329284000000000,0.329369000000000,0.249765000000000,0,0,0,0,0,0,0.0443034000000000,0.0382706000000000,0.0506299000000000,0.0568593000000000,0.0558728000000000,0.0186524000000000,0.0184769000000000,0.0950023000000000,0,0,0,0,0;0,0,0,0,0,0.00263351000000000,0.00263351000000000,0.326984000000000,0.326809000000000,0.244172000000000,0,0,0,0,0,0,0.0476069000000000,0.0367406000000000,0.0451677000000000,0.0568924000000000,0.0559705000000000,0.0189288000000000,0.0197043000000000,0.0919017000000000,0,0,0,0,0;0,0,0,0,0,0.00179271000000000,0.00179271000000000,0.327409000000000,0.327534000000000,0.243124000000000,0,0,0,0,0,0,0.0471916000000000,0.0365530000000000,0.0451659000000000,0.0566153000000000,0.0562173000000000,0.0188603000000000,0.0196636000000000,0.0907869000000000,0,0,0,0,0;0,0,0,0,0,0,0,0.327739000000000,0.327740000000000,0.249947000000000,0,0,0,0,0,0,0.0390233000000000,0.0256213000000000,0.0514709000000000,0.0556982000000000,0.0561129000000000,0.0146494000000000,0.0158288000000000,0.103098000000000,0,0,0,0,0;0,0,0,0,0,0,0,0.328336000000000,0.328606000000000,0.251416000000000,0,0,0,0,0,0,0.0408628000000000,0.0180839000000000,0.0528941000000000,0.0532157000000000,0.0532528000000000,0.0190324000000000,0.0193240000000000,0.0988646000000000,0,0,0.00139695000000000,0,0;0,0,0,0,0,0,0,0.328186000000000,0.328221000000000,0.251601000000000,0,0,0,0,0,0,0.0412122000000000,0.0177411000000000,0.0529342000000000,0.0536302000000000,0.0534365000000000,0.0188069000000000,0.0191856000000000,0.0990389000000000,0,0,0.000543780000000000,0,0;0,0,0,0,0,0,0,0.328407000000000,0.328432000000000,0.251344000000000,0,0,0,0,0,0,0.0415867000000000,0.0176978000000000,0.0520575000000000,0.0520505000000000,0.0518102000000000,0.0186931000000000,0.0190818000000000,0.0988833000000000,0,0,0.00119979000000000,0,0;0.198959000000000,0.199103000000000,0.198940000000000,0.199589000000000,0.199631000000000,0.217751000000000,0.217727000000000,0.119120000000000,0.119049000000000,0.0917346000000000,0.114165000000000,0.114613000000000,0.114809000000000,0.108035000000000,0.107731000000000,0.0936857000000000,0.00218994000000000,0,0,0,0,0.0157288000000000,0.0163067000000000,0.0397120000000000,0,0.00318328000000000,0.0782186000000000,0.587650000000000,0.587650000000000;0.235099000000000,0.235293000000000,0.235109000000000,0.233115000000000,0.230742000000000,0.227436000000000,0.227439000000000,0.0689200000000000,0.0688186000000000,0.0468598000000000,0.181426000000000,0.181389000000000,0.181346000000000,0.201794000000000,0.201631000000000,0.178752000000000,0.0419877000000000,0,0.0118638000000000,0,0,0,0,0.00153117000000000,0.0115884000000000,0.0282246000000000,0.0785326000000000,0.800638000000000,0.800638000000000];
heatmap(MI_voltAng_currMag,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_currents];
ax.YData =[target_phase_names_voltages];
title ('VoltageAng-CurrentMag')


figure
MI_voltMag_currAng = [1.17854000000000,1.17633000000000,1.17531000000000,1.14898000000000,1.10983000000000,1.08145000000000,1.08142000000000,0.265982000000000,0.262410000000000,0.254858000000000,0.610386000000000,0.613743000000000,0.613079000000000,0.603009000000000,0.602610000000000,0.582612000000000,0.294843000000000,0.0255661000000000,0.288904000000000,0.253914000000000,0.253869000000000,0.0220672000000000,0.0225706000000000,0.0348525000000000,0,0.0118173000000000,0,0.182050000000000,0.182064000000000;1.17095000000000,1.17029000000000,1.16872000000000,1.13958000000000,1.10793000000000,1.07898000000000,1.07897000000000,0.267881000000000,0.264448000000000,0.248281000000000,0.610137000000000,0.610543000000000,0.610803000000000,0.593313000000000,0.593624000000000,0.577700000000000,0.304843000000000,0.0264311000000000,0.292350000000000,0.253527000000000,0.253522000000000,0.0238293000000000,0.0249158000000000,0.0343013000000000,0,0.00927486000000000,0,0.184999000000000,0.184941000000000;1.17753000000000,1.17643000000000,1.17620000000000,1.14474000000000,1.11395000000000,1.08759000000000,1.08757000000000,0.260440000000000,0.260532000000000,0.231308000000000,0.592358000000000,0.593735000000000,0.594139000000000,0.583527000000000,0.583175000000000,0.573717000000000,0.321136000000000,0.0320303000000000,0.314759000000000,0.249373000000000,0.249384000000000,0.0182633000000000,0.0181520000000000,0.0205976000000000,0,0,0,0.195952000000000,0.195952000000000;1.18645000000000,1.18622000000000,1.18479000000000,1.15140000000000,1.11662000000000,1.09425000000000,1.09416000000000,0.260812000000000,0.261508000000000,0.224279000000000,0.593702000000000,0.596307000000000,0.596500000000000,0.585518000000000,0.585193000000000,0.573058000000000,0.324575000000000,0.0279103000000000,0.316555000000000,0.251614000000000,0.251574000000000,0.0114026000000000,0.0129409000000000,0.0230863000000000,0,0,0,0.195593000000000,0.195585000000000;1.19070000000000,1.18910000000000,1.18757000000000,1.15383000000000,1.11848000000000,1.09495000000000,1.09492000000000,0.259640000000000,0.259129000000000,0.218149000000000,0.595771000000000,0.595713000000000,0.596703000000000,0.585137000000000,0.584849000000000,0.573142000000000,0.327966000000000,0.0290069000000000,0.317888000000000,0.251643000000000,0.251573000000000,0.00824278000000000,0.00835322000000000,0.0295674000000000,0,0.00462259000000000,0,0.193829000000000,0.193776000000000;0.277579000000000,0.278411000000000,0.277060000000000,0.260992000000000,0.263363000000000,0.254499000000000,0.254480000000000,0.0369817000000000,0.0405638000000000,0.0497641000000000,0.205574000000000,0.207253000000000,0.207542000000000,0.181036000000000,0.181168000000000,0.188492000000000,0.109385000000000,0.0564226000000000,0.151544000000000,0.0996775000000000,0.0997220000000000,0,0,0,0.00471834000000000,0.000967402000000000,0,0.0552247000000000,0.0552315000000000;0.273823000000000,0.273797000000000,0.273619000000000,0.261170000000000,0.262215000000000,0.257613000000000,0.257626000000000,0.0333337000000000,0.0330997000000000,0.0496774000000000,0.200415000000000,0.202886000000000,0.203329000000000,0.183883000000000,0.183621000000000,0.193506000000000,0.123528000000000,0.0481536000000000,0.141261000000000,0.100886000000000,0.100930000000000,0,0,0,0.0203150000000000,0.0101601000000000,0,0.0537147000000000,0.0537390000000000;0.296793000000000,0.296281000000000,0.295131000000000,0.286182000000000,0.288039000000000,0.273418000000000,0.273478000000000,0.0343985000000000,0.0362963000000000,0.0372065000000000,0.181473000000000,0.187677000000000,0.189036000000000,0.212248000000000,0.212266000000000,0.214672000000000,0.109395000000000,0.0278340000000000,0.114525000000000,0.0965615000000000,0.0966066000000000,0,0,0,0,0.0125234000000000,0.00247177000000000,0.0489431000000000,0.0488417000000000;0.136598000000000,0.134928000000000,0.134513000000000,0.132361000000000,0.139975000000000,0.127861000000000,0.127878000000000,0.697446000000000,0.696426000000000,0.630479000000000,0.0973671000000000,0.0998116000000000,0.100001000000000,0.105029000000000,0.105031000000000,0.107342000000000,0.0513352000000000,0.0560573000000000,0.0388535000000000,0.0815327000000000,0.0815016000000000,0,0,0,0,0,0.195140000000000,0.0321019000000000,0.0320701000000000;0.130923000000000,0.130942000000000,0.131177000000000,0.128021000000000,0.131554000000000,0.125986000000000,0.125986000000000,0.780412000000000,0.776384000000000,0.686784000000000,0.107526000000000,0.104393000000000,0.103706000000000,0.0949816000000000,0.0947145000000000,0.0912551000000000,0.0409060000000000,0.0301298000000000,0.0493669000000000,0.0209831000000000,0.0209704000000000,0,0,0,0,0,0.188490000000000,0.0109982000000000,0.0109982000000000;0.154113000000000,0.154466000000000,0.153681000000000,0.147639000000000,0.149149000000000,0.154271000000000,0.154195000000000,0.113288000000000,0.107181000000000,0.0724464000000000,0.141401000000000,0.141646000000000,0.141432000000000,0.126086000000000,0.125870000000000,0.122808000000000,0.0828523000000000,0,0.107728000000000,0.0506472000000000,0.0507538000000000,0,0,0.00457233000000000,0,0,0.0689769000000000,0.0838676000000000,0.0838354000000000;0.168610000000000,0.168672000000000,0.168506000000000,0.164013000000000,0.170670000000000,0.174037000000000,0.174085000000000,0.102918000000000,0.101053000000000,0.0658077000000000,0.149394000000000,0.151103000000000,0.150491000000000,0.129437000000000,0.128882000000000,0.128323000000000,0.0877285000000000,0,0.0989856000000000,0.0642716000000000,0.0643260000000000,0,0,0.0173812000000000,0,0.00399670000000000,0.0662820000000000,0.0838902000000000,0.0837154000000000;0.403314000000000,0.402169000000000,0.402079000000000,0.395393000000000,0.397074000000000,0.396337000000000,0.396333000000000,0.0483726000000000,0.0504736000000000,0.0661050000000000,0.486683000000000,0.484368000000000,0.483654000000000,0.487208000000000,0.486815000000000,0.460406000000000,0.235387000000000,0.00705468000000000,0.225254000000000,0.193551000000000,0.193573000000000,0,0,0,0.0213385000000000,0,0.0567770000000000,0.168933000000000,0.168917000000000;0.402113000000000,0.402111000000000,0.402948000000000,0.397459000000000,0.397925000000000,0.395933000000000,0.395869000000000,0.0405334000000000,0.0408571000000000,0.0558753000000000,0.499314000000000,0.496104000000000,0.495716000000000,0.501908000000000,0.501422000000000,0.478430000000000,0.229672000000000,0.00894754000000000,0.227324000000000,0.190349000000000,0.190354000000000,0,0,0,0.0343814000000000,0,0.0570295000000000,0.180598000000000,0.180628000000000;0.679340000000000,0.679098000000000,0.679519000000000,0.667826000000000,0.672453000000000,0.667546000000000,0.667563000000000,0.0484788000000000,0.0497123000000000,0.00745004000000000,0.911860000000000,0.905084000000000,0.904517000000000,0.912660000000000,0.912882000000000,0.911856000000000,0.344500000000000,0.0377766000000000,0.370092000000000,0.337990000000000,0.338051000000000,0,0,0,0.0249303000000000,0,0.0393889000000000,0.230451000000000,0.230433000000000;0.124683000000000,0.124492000000000,0.123954000000000,0.110153000000000,0.119636000000000,0.126051000000000,0.126051000000000,0.0321165000000000,0.0315031000000000,0.00284573000000000,0.0963902000000000,0.100170000000000,0.100490000000000,0.0926557000000000,0.0927517000000000,0.102547000000000,0.0633466000000000,0,0.0606328000000000,0.0508726000000000,0.0509164000000000,0.000483413000000000,0.000696026000000000,0.0136211000000000,0,0,0.00160327000000000,0.0552477000000000,0.0552701000000000;0.0441502000000000,0.0442194000000000,0.0449132000000000,0.0611077000000000,0.0781213000000000,0.0820726000000000,0.0821084000000000,0.0427181000000000,0.0438068000000000,0,0.0525251000000000,0.0552447000000000,0.0553536000000000,0.0551626000000000,0.0547988000000000,0.0626080000000000,0.0276148000000000,0,0.0276434000000000,0.000143644000000000,0.000179074000000000,0,0,0.0235957000000000,0,0.0342922000000000,0,0.0415678000000000,0.0414713000000000;0.0433735000000000,0.0439299000000000,0.0444068000000000,0.0605267000000000,0.0791256000000000,0.0819590000000000,0.0819423000000000,0.0438541000000000,0.0446448000000000,0,0.0531371000000000,0.0558956000000000,0.0558044000000000,0.0551671000000000,0.0547177000000000,0.0622074000000000,0.0280169000000000,0,0.0281560000000000,0.000672319000000000,0.000694136000000000,0,0,0.0240299000000000,0,0.0335573000000000,0,0.0415283000000000,0.0413518000000000;0,0,0,0.00728759000000000,0.0104373000000000,0.0177266000000000,0.0177384000000000,0.0159676000000000,0.0146696000000000,0.0491969000000000,0.0237921000000000,0.0230010000000000,0.0232941000000000,0.0370897000000000,0.0371926000000000,0.0326357000000000,0.0264155000000000,0.0372929000000000,0.0191172000000000,0.0269141000000000,0.0269518000000000,0,0,0,0.00377892000000000,0.0178959000000000,0,0.101061000000000,0.101120000000000;0,0,0,0.00476828000000000,0.0120029000000000,0.0246627000000000,0.0246377000000000,0.0137286000000000,0.0128587000000000,0.0493805000000000,0.0210878000000000,0.0222022000000000,0.0219996000000000,0.0378000000000000,0.0383682000000000,0.0316910000000000,0.0250149000000000,0.0400956000000000,0.0182932000000000,0.0292841000000000,0.0292756000000000,0.000996521000000000,0.00166000000000000,0,0.00372294000000000,0.0149959000000000,0,0.0993095000000000,0.0993711000000000;0.0223675000000000,0.0219511000000000,0.0215086000000000,0.0210697000000000,0.0283993000000000,0.0286789000000000,0.0286908000000000,0.00872153000000000,0.00855503000000000,0.0317021000000000,0.0257491000000000,0.0244981000000000,0.0246612000000000,0.0523749000000000,0.0528411000000000,0.0433101000000000,0.0147283000000000,0.0444998000000000,0.0163685000000000,0.0384215000000000,0.0384354000000000,0.0474663000000000,0.0492271000000000,0,0.00417139000000000,0.0459678000000000,0,0.0661978000000000,0.0662130000000000;0.0225379000000000,0.0221620000000000,0.0223244000000000,0.0272031000000000,0.0424371000000000,0.0482884000000000,0.0482546000000000,0.0269394000000000,0.0260818000000000,0.0260877000000000,0.00844328000000000,0.00935084000000000,0.00938478000000000,0.0447387000000000,0.0452543000000000,0.0326025000000000,0.0122860000000000,0.0344661000000000,0.00544013000000000,0.0350474000000000,0.0352000000000000,0.0486348000000000,0.0497466000000000,0,0,0.0272935000000000,0.00387419000000000,0.0472440000000000,0.0472587000000000;0.0221279000000000,0.0221779000000000,0.0229048000000000,0.0264097000000000,0.0410325000000000,0.0506517000000000,0.0505944000000000,0.0284841000000000,0.0282637000000000,0.0261323000000000,0.00723632000000000,0.00764861000000000,0.00807692000000000,0.0431619000000000,0.0435682000000000,0.0314323000000000,0.0101685000000000,0.0325568000000000,0.00370937000000000,0.0332050000000000,0.0331884000000000,0.0484564000000000,0.0502253000000000,0,0,0.0262382000000000,0.00685539000000000,0.0457143000000000,0.0457058000000000;0.00246752000000000,0.00346354000000000,0.00313865000000000,0.0103166000000000,0.0131003000000000,0.0188804000000000,0.0188119000000000,0.0124299000000000,0.0139695000000000,0.0503818000000000,0.0276564000000000,0.0279823000000000,0.0276895000000000,0.0282304000000000,0.0283983000000000,0.0260817000000000,0.0307260000000000,0.0253831000000000,0.0220081000000000,0.0294477000000000,0.0295294000000000,0,0,0,0,0.0289825000000000,0,0.0953898000000000,0.0954032000000000;0.00166717000000000,0.00203545000000000,0.00203153000000000,0.00681987000000000,0.0180545000000000,0.0250275000000000,0.0249448000000000,0.0192921000000000,0.0202381000000000,0.0429839000000000,0.0363883000000000,0.0356661000000000,0.0359408000000000,0.0287863000000000,0.0293825000000000,0.0270076000000000,0.0281001000000000,0.0220337000000000,0.0202982000000000,0.0342590000000000,0.0342605000000000,0,0,0,0,0.0242007000000000,0,0.0972754000000000,0.0972679000000000;0.000372604000000000,0.00107398000000000,0.000731895000000000,0.00767559000000000,0.0188716000000000,0.0274730000000000,0.0274083000000000,0.0197309000000000,0.0190980000000000,0.0404117000000000,0.0388206000000000,0.0363166000000000,0.0366161000000000,0.0314981000000000,0.0315306000000000,0.0284251000000000,0.0284818000000000,0.0247567000000000,0.0201631000000000,0.0362427000000000,0.0362713000000000,0,0,0,0,0.0226844000000000,0,0.0977696000000000,0.0977786000000000;0.00161665000000000,0.00213586000000000,0.00202837000000000,0.00692128000000000,0.0183607000000000,0.0250945000000000,0.0250311000000000,0.0194513000000000,0.0204154000000000,0.0428093000000000,0.0365826000000000,0.0358855000000000,0.0360070000000000,0.0286383000000000,0.0292742000000000,0.0268238000000000,0.0281008000000000,0.0220405000000000,0.0208017000000000,0.0340470000000000,0.0340816000000000,0,0,0,0,0.0243267000000000,0,0.0975131000000000,0.0974945000000000;0.117761000000000,0.118022000000000,0.118491000000000,0.119649000000000,0.131414000000000,0.134542000000000,0.134597000000000,0.0164975000000000,0.0187490000000000,0.0406321000000000,0.154470000000000,0.150293000000000,0.150484000000000,0.148216000000000,0.148329000000000,0.143736000000000,0.00384172000000000,0,0.0142982000000000,0.0477016000000000,0.0476641000000000,0,0,0,0.0281925000000000,0.0536668000000000,0.0249045000000000,0.955188000000000,0.955245000000000;0.160283000000000,0.160532000000000,0.160986000000000,0.157053000000000,0.167356000000000,0.179733000000000,0.179708000000000,0.0122728000000000,0.0129096000000000,0.00728061000000000,0.192113000000000,0.189791000000000,0.189642000000000,0.186372000000000,0.186050000000000,0.185928000000000,0.0466144000000000,0.00115323000000000,0.0580059000000000,0.0384793000000000,0.0384922000000000,0.00640379000000000,0.00571011000000000,0.0238377000000000,0.0129667000000000,0.0256635000000000,0.0110306000000000,1.64370000000000,1.64369000000000];
heatmap(MI_voltMag_currAng,'FontName', 'Times New Roman', 'FontSize', 16,'Colormap',parula)
ax = gca;
ax.XData =[target_phase_names_currents];
ax.YData =[target_phase_names_voltages];
title ('VoltageMag-CurrentAng')










%% just voltages
% load 500Scen
% load voltage_names
% %node_voltage_names_separated(1:3,:) = [];
% %node_voltage_names_separated([23,27,28,73],:)=[];
% %R_input(:,[1:1+2,size(R_input,2)/2+1:size(R_input,2)/2+2+1]) = [];
% target_phase = find (str2double(node_voltage_names_separated(:,2))==1); %last parameter should be 1 for phase A 2 for phase B and 3 for phase C
% % for i = 1:length(node_voltage_names_separated)
% %     if strcmp(node_voltage_names_separated{i}(4),'1')
% %         ground_truth{i,1} = 2;
% %     elseif strcmp(node_voltage_names_separated{i}(4),'2')
% %         ground_truth{i,1} = 0;
% %     else
% %         ground_truth{i,1} = 1;
% %     end
% % end
% % target_ground_truth = cell2mat(ground_truth(target_phase));
% target_phase_for_SP = target_phase+length(node_voltage_names_separated);
% R_input_for_SP_score = R_input(:,target_phase_for_SP);
% R = corrcoef(R_input);
% %R = corr(R_input,'type','Spearman');
% Amatrix = R-eye(size(R,1));
% Amatrix_mag = Amatrix(1:size(Amatrix,2)/2,1:size(Amatrix,2)/2);
% Amatrix_phase = Amatrix(size(Amatrix,2)/2+1:size(Amatrix,2),size(Amatrix,2)/2+1:size(Amatrix,2));
% Amatrix_phase_target_phase = Amatrix_phase(target_phase,target_phase);
% Amatrix_mag_target_phase = Amatrix_mag(target_phase,target_phase);
% % copy and paste spectral clustering from python
% % SC_results = [2;2;2;2;2;2;2;2;2;2;2;2;2;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;2;2;2;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1];
% % SC_results_index = [transpose(1:size(SC_results,1)),SC_results];
% % sorted_SC_results = sortrows(SC_results_index,2);
% % plotting heatmaps before and after of SC
% figure 
% heatmap(Amatrix_phase_target_phase+eye(size(Amatrix_mag_target_phase)))
% %figure
% %heatmap(Amatrix_mag_target_phase+eye(size(Amatrix_mag_target_phase)))
% heatmap_axis_names_in_order = node_voltage_names_separated(target_phase);
%writematrix(R_input_for_SP_score,'C:\Users\bazimian\OneDrive\Research\Dr. Anamitra Pal\34 Node system\34 node system\Spectral clusterting\input_for_score.csv')
%writematrix(Amatrix_phase_target_phase,'C:\Users\bazimian\OneDrive\Research\Dr. Anamitra Pal\34 Node system\34 node system\Spectral clusterting\spectral_clustering.csv')
%% calculating accuracy
% accuracy = (size(target_ground_truth)-length(find (target_ground_truth - SC_results ~= 0)))/size(target_ground_truth)*100;